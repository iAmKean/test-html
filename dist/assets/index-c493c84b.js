import{B as Y,E as k,r as h,g as F,o as l,c as r,a as e,t as y,u as o,C as f,n as d,e as me,z as pe,d as _e,s as fe,l as he,h as B,i as z,j as se,b as P,I as Be,J as Ce}from"./index-0d29c91c.js";import{f as ae,d as ne,a as Te,e as Me}from"./dateHelper-f75861f0.js";import{f as Se}from"./vouchers-0dc779af.js";import{u as Ie}from"./testData-146d1d9c.js";import{a as le,_ as ie}from"./AppLoader-c0c74b58.js";import{a as Ne,_ as Ee,b as Pe,d as Fe,e as Oe,g as Ve}from"./BookingSummary-2ea2a3f4.js";/* empty css                                                               */import{_ as ce}from"./icn-intruction-cc70d524.js";import{f as re}from"./numberHelper-25d49756.js";import{c as de}from"./AppLoader.vue_vue_type_style_index_0_lang-2e650906.js";import ue from"./AppModal-b27e53ae.js";import"./booking-84804f94.js";import{a as Ae}from"./manageBooking-5b991d8c.js";import{g as Ue}from"./manageBookingGuest-a3976bc7.js";import{_ as je}from"./_plugin-vue_export-helper-c27b6911.js";import"./axiosConfig-15342d77.js";const He={class:"bg-white text-[#000000DE] md:bg-[#F6F6F6]"},Ge=e("div",{class:"leading-6 font-bold"},"Confirmation Number:",-1),We={class:"leading-5"},ze={key:0,class:"mt-1 text-danger text-12-16"},Ye=["src"],Je={class:"flex flex-col mt-2 md:mt-4"},qe={class:"leading-6 text-[24px]"},Ke={class:"font-bold leading-4 text-[10px]"},Le=e("div",{class:"border-y-[1px] mt-4"},null,-1),Qe={class:"mt-4"},Xe=e("div",{class:"leading-6 text-[20px] font-medium ."}," Date of Travel & Room ",-1),Ze={class:"flex mt-[21.51px] gap-11"},et={class:"flex-1"},tt=e("div",{class:"text-[14px] leading-6 font-bold"},"Check- in",-1),ot={class:"text-[14px] leading-5 flex gap-[18.75px] items-center"},st={class:"flex-1"},at=e("div",{class:"text-[14px] leading-6 font-bold"},"Check-out",-1),nt={class:"text-[14px] leading-5 flex gap-[18.75px] items-center"},lt={class:"flex mt-[21.31px] gap-11"},it=e("div",{class:"text-[14px] leading-6 font-bold"}," Number of Rooms ",-1),ct={class:"text-[14px] leading-5 flex gap-[18.75px] items-center"},rt=e("div",{class:"border-y-[1px] mt-4"},null,-1),dt={__name:"HotelDetails",props:{fetchedDetails:{type:Object,default:{}}},setup(C){const T=C,S=Y(),u=k(()=>T.fetchedDetails),O=h({hotel:!1,card:!1});return F(()=>O.value,m=>{S.setPaymentMethod(m)},{deep:!0}),(m,a)=>{var p,D,w,R,M;return l(),r("div",He,[e("div",{class:d([" hidden mt-[33px] border rounded-md py-4 px-8 text-14-24 md:block",((p=o(u))==null?void 0:p.status)===2?"border-[#DB1126] bg-[#FFF1F1]":"bg-[#1AB55C42] border-[#046A38] "])},[Ge,e("div",We,y(o(u).confirmation_no||"---"),1),((D=o(u))==null?void 0:D.status)===2?(l(),r("div",ze,y((w=o(u))==null?void 0:w.date_cancelled),1)):f("",!0)],2),e("img",{class:"view-booking cursor-pointer aspect-video object-cover w-full md:mt-5 md:rounded-md md:object-fill",src:o(u).thumbnail},null,8,Ye),e("div",Je,[e("div",qe,y(((R=o(u))==null?void 0:R.property_name)||"---"),1),e("div",Ke,y(((M=o(u))==null?void 0:M.property_location)||"---"),1)]),Le,e("div",Qe,[Xe,e("div",Ze,[e("div",et,[tt,e("div",ot,[e("span",null,y(o(u).check_in?o(ae)(new Date(o(u).check_in),!0):"---"),1)])]),e("div",st,[at,e("div",nt,[e("span",null,y(o(u).check_in?o(ae)(new Date(o(u).check_out),!0):"---"),1)])])]),e("div",lt,[e("div",null,[it,e("div",ct,[e("span",null,y(o(u).number_of_rooms||"0")+" Room"+y(o(u).number_of_rooms>1?"s":""),1)])])])]),rt])}}},ut={class:d(["shadow-lg"," flex","flex-col","rounded-lg md:shadow-2xl bg-white"])},mt=e("div",{class:"leading-6 font-bold"},"Confirmation Number:",-1),pt={class:"leading-5"},_t={key:0,class:"mt-1 text-danger text-12-16"},ft={class:d(["mt-4","px-4 py-2","flex","items-center","justify-between","hover:bg-[#E3F3E6]"])},ht={class:d(["flex","gap-[10px]","items-center"])},yt=e("div",null,[e("div",{class:d(["font-bold","text-14-24",""])}," Payment Option "),e("div",{class:d(["font-medium","text-12-16","","text-primary","cursor-pointer","hidden"])}," Select Payment Method ")],-1),vt={key:0,class:d(["flex items-center gap-1 text-14-16","font-bold","text-primary"])},bt={key:1,class:d(["flex items-center gap-1 text-14-16","font-bold","text-primary"])},gt={key:2,class:d(["flex items-center gap-1 text-12-16",""])},xt=["src"],kt=e("div",{class:d(["flex","gap-[10px]","items-center"])},[e("div",{class:"w-5"}),e("div",null,[e("div",{class:d(["font-bold","text-14-24",""])}," Total Amount "),e("div",{class:d(["font-medium","text-12-16","","text-primary","cursor-pointer"])}," View booking summary ")])],-1),Dt={class:d(["font-bold","text-16-24",""])},wt={key:0},Rt={key:1},$t=["disabled"],Bt={key:1},Ct={key:2},Tt=e("span",null,"Cancel Booking",-1),Mt={key:2,class:"mt-2 mb-5 mx-[10px]"},St={key:0,class:"flex gap-2"},It=e("span",{class:"text-xs"},"For booking changes, please download our Hotel101 mobile application.",-1),Nt={key:3,class:"mb-5"},Et={class:"flex justify-center"},Pt=e("br",null,null,-1),Ft=e("div",{class:"flex justify-center mt-2"},[e("strong",null,"Pending Payment")],-1),Ot={class:"text-14-20 letter-spacing-25 mt-5"},Vt=e("div",null," You have an outstanding balance, please settle by clicking the Pay Balance below. ",-1),At={class:"mt-5 letter-spacing-1-25 flex flex-col font-medium"},Ut={class:"flex justify-center"},jt={class:"text-14-20 mt-5"},Ht={key:0},Gt=e("br",null,null,-1),Wt={key:1},zt={key:2},Yt=e("br",null,null,-1),Jt=e("br",null,null,-1),qt={class:"mt-5 flex flex-col font-medium"},Kt={__name:"Summary",props:{fetchedDetails:{type:Object,default:{}}},setup(C){const T=C,S=me(),u=pe(),O=_e(),m=k(()=>{var s;return(s=O.params)==null?void 0:s.confirmationNo}),a=Y();fe(),Ie();const p=h(!1),D=h(!1),w=h(!1),R=h(!1),M=h(""),j=h(""),t=h(k(()=>T.fetchedDetails)),v=h(!1),_=h(!1),i=()=>{localStorage.removeItem("_IS_UPDATE"),localStorage.removeItem("_CURRENTVOUCHER_FROM_VIEW"),a.booking={};const{property_id:s,property_name:n,check_out:b,check_in:$,number_of_rooms:G,rates:I}=T.fetchedDetails;a.booking.area=n,a.booking.propertyId=s,a.booking.startDate=$,a.booking.endDate=b,a.booking.roomCount=G;const V=new Date,A=new Date($),W=ne(A);if(A>V)a.booking.date=[$,W],a.booking.bookDate=[$,b];else{const N=Te(V),E=ne();a.booking.startDate=N,a.booking.endDate=E,a.booking.date=[N,E],a.booking.bookDate=[N,E]}a.booking.stay=I==null?void 0:I.length,u.push({name:"BaseRoute::searchResult"})},c=k(()=>Fe(t.value)),ye=k(()=>{var s;return(s=T.fetchedDetails)==null?void 0:s.ancillary}),ve=k(()=>t.value?Oe(a.addOns,t.value)*t.value.number_of_rooms:0),be=k(()=>g.value?Number(g.value.voucher_discount):0),ge=k(()=>{if(!g.value)return 0;const{points_redeemed:s}=g.value;return parseFloat(s)}),xe=k(()=>{if(!g.value)return 0;const{total_payable:s}=g.value;return s}),g=k(()=>T.fetchedDetails.invoice),ke=k(()=>{if(!g.value)return 0;const{tax_percent:s,tax_fixed:n,service_charge:b,total_payable:$}=g.value;return Ve($,s,n,b)}),De=()=>{var s;if(t.value.invoice.status=="Pending"&&t.value.invoice.Payment_method!=="Pay at Hotel"&&a.paymentMethod.link){w.value=!0;return}if(((s=t.value)==null?void 0:s.refund_policy)===2||!_.value){S.alertModal={state:!0,content:"Updating the non-refundable booking is not allowed."};return}localStorage.setItem("_IS_UPDATE","1"),localStorage.removeItem("_ROOMRATES"),H.value&&H.value.mod_type?localStorage.setItem("_CURRENTVOUCHER_FROM_VIEW",JSON.stringify(H.value)):localStorage.removeItem("_CURRENTVOUCHER_FROM_VIEW"),u.push({name:"BaseRoute::UpdateBooking",params:{confirmationNo:m.value}})},we=()=>{window.location.href=a.paymentMethod.link},H=h({}),Re=async s=>{const n=await Se(s);if(n.status==200){var b=n.data;b.booking_discount=g.value.voucher_discount,a.vouchers=b,M.value=b.mod_type+"",j.value=b.mod_value,H.value=b}};return F(()=>g.value,s=>{s.voucher_id&&Re(s.voucher_id)}),F(()=>ye.value,s=>{a.addOns=s.map(n=>({name:n.name,count:n.quantity,rate:n.unit_rate,policy_type:n.policy_type,selected:!0}))}),F(()=>t.value,s=>{if(t.value){if(a.booking.isNotRefundable=!1,(s==null?void 0:s.refund_policy)===1&&(s==null?void 0:s.cancellation_days)!==null){if((s==null?void 0:s.cancellation_days)===0){a.booking.isBeyondRefundable=_.value=!0;return}a.booking.isBeyondRefundable=_.value=Me(s==null?void 0:s.cancellation_days,s==null?void 0:s.check_in)}t.value.status===2&&_.value===!1&&a.paymentMethod.hotel&&(a.booking.isNotRefundable=!0)}}),he(()=>{localStorage.removeItem("_CURRENTVOUCHER_FROM_VIEW"),localStorage.removeItem("_REBOOK_DETAILS")}),S.alertModal.state=!1,(s,n)=>{var b,$,G,I,V,A,W,N,E,J,q,K,L,Q,X,Z,ee;return l(),r("div",ut,[e("div",{class:d([" border rounded-md py-4 px-8 text-14-24 md:hidden",((b=t.value)==null?void 0:b.status)===2?"border-[#DB1126] bg-[#FFF1F1]":"bg-[#1AB55C42] border-[#046A38] "])},[mt,e("div",pt,y(t.value.confirmation_no||"---"),1),(($=t.value)==null?void 0:$.status)===2?(l(),r("div",_t,y((G=t.value)==null?void 0:G.date_cancelled),1)):f("",!0)],2),e("div",ft,[e("div",ht,[B(o(Ne)),yt]),o(a).paymentMethod.hotel?(l(),r("div",vt," Pay at Hotel ")):((I=o(g))==null?void 0:I.status)=="Pending"?(l(),r("div",bt," Pending Payment ")):(l(),r("div",gt,[e("img",{class:"w-6 h-6",src:((V=o(a).paymentMethod.cardDetails)==null?void 0:V.brand)==="amex"?o(de)("americanexpress"):o(de)((A=o(a).paymentMethod.cardDetails)==null?void 0:A.brand)},null,8,xt),e("span",null,y((W=o(a).paymentMethod.cardDetails)==null?void 0:W.last4),1)]))]),e("div",{class:d(["px-4 py-2","flex","items-center","justify-between","hover:bg-[#E3F3E6]"]),onClick:n[0]||(n[0]=x=>p.value=!0)},[kt,e("div",Dt,[o(a).booking.isNotRefundable?(l(),r("span",wt,y(o(re)(t.value.currency,0,2)),1)):(l(),r("span",Rt,y(o(re)(t.value.currency,((N=o(g))==null?void 0:N.total_payable)??0,2)),1))])]),((E=t.value)==null?void 0:E.status)!==3?(l(),r("button",{key:0,type:"button",class:d(["mt-7","mt-1","mx-[18px]","btn-primary","py-[14px]","rounded-lg","text-sm","leading-[17px]","font-medium flex items-center justify-center",{"btn-primary-disable":R.value||v.value},{"mb-5":[1,2].includes((J=t.value)==null?void 0:J.status)}]),onClick:n[1]||(n[1]=x=>{var U;return[1,2].includes((U=t.value)==null?void 0:U.status)?i():De()}),disabled:R.value||v.value},[R.value?(l(),z(o(le),{key:0,color:"#ffff"})):f("",!0),[1,2].includes((q=t.value)==null?void 0:q.status)?(l(),r("span",Bt," Rebook This Property ")):(l(),r("span",Ct,"Manage Booking"))],10,$t)):f("",!0),((K=t.value)==null?void 0:K.status)===4?(l(),r("button",{key:1,type:"button",class:d(["mt-2","mx-[18px]","btn-primary-outline","py-[14px]","mb-5","rounded-lg","text-sm","leading-[17px]","font-medium flex items-center justify-center",{"btn-primary-disable":R.value},{"mb-0":((L=t.value)==null?void 0:L.status)===4}]),onClick:n[2]||(n[2]=x=>D.value=!0)},[R.value?(l(),z(o(le),{key:0,color:"#ffff"})):f("",!0),Tt],2)):f("",!0),((Q=t.value)==null?void 0:Q.status)===4?(l(),r("div",Mt,[v.value?(l(),r("div",St,[B(o(Ee),{size:"15px",class:"w-[30px]"}),It])):f("",!0)])):f("",!0),((X=t.value)==null?void 0:X.status)===3?(l(),r("div",Nt)):f("",!0),B(Pe,{_mod_type:M.value,show:p.value,propertyDetail:t.value,fetchedDetails:t.value,computedRoomTotal:o(c),computedAddonTotal:o(ve),computedVoucherTotal:M.value=="3"?parseFloat(j.value):o(be),computedPointsRedeemedTotal:o(ge),computedTaxes:((Z=t.value)==null?void 0:Z.status)===2?0:o(ke),totalAmount:((ee=t.value)==null?void 0:ee.status)===2?0:o(xe),"onUpdate:show":n[3]||(n[3]=x=>p.value=x)},null,8,["_mod_type","show","propertyDetail","fetchedDetails","computedRoomTotal","computedAddonTotal","computedVoucherTotal","computedPointsRedeemedTotal","computedTaxes","totalAmount"]),B(o(ue),{show:w.value,"onUpdate:show":n[5]||(n[5]=x=>w.value=x),containerClass:"w-[300px] h-auto"},{default:se(()=>[e("div",Et,[B(o(ce)),Pt]),Ft,e("div",Ot,[Vt,e("div",At,[e("button",{type:"button",class:"py-[14px] btn-primary",onClick:we}," Pay Balance "),e("button",{type:"button",class:"py-[14px] mt-2 btn-primary-outline",onClick:n[4]||(n[4]=x=>w.value=!1)}," Close ")])])]),_:1},8,["show"]),B(o(ue),{show:D.value,"onUpdate:show":n[8]||(n[8]=x=>D.value=x),containerClass:"w-[300px] h-auto"},{default:se(()=>{var x,U,te,oe;return[e("div",Ut,[B(o(ce))]),e("div",jt,[((x=t.value)==null?void 0:x.refund_policy)===2?(l(),r("div",Ht,[P(" If you cancel, this booking is "),Gt,P(" non-refundable. ")])):f("",!0),((U=t.value)==null?void 0:U.refund_policy)===1&&_.value?(l(),r("div",Wt,[P(" You are about to cancel the booking with the confirmation number of "),e("strong",null,y((te=t.value)==null?void 0:te.confirmation_no)+".",1)])):f("",!0),((oe=t.value)==null?void 0:oe.refund_policy)===1&&!_.value?(l(),r("div",zt,[P(" If you cancel, this booking is "),Yt,P(" non-refundable since it's already "),Jt,P(" beyond the allowed period. ")])):f("",!0),e("div",qt,[e("button",{type:"button",class:"py-[14px] btn-primary",onClick:n[6]||(n[6]=$e=>s.$router.push({name:"BaseRoute::CancelBooking",params:{confirmationNo:o(m)}}))}," Yes, cancel the booking "),e("button",{type:"button",class:"py-[14px] mt-2 btn-primary-outline",onClick:n[7]||(n[7]=$e=>D.value=!1)}," No, I don't want to cancel ")])])]}),_:1},8,["show"])])}}};const Lt=C=>(Be("data-v-b649f117"),C=C(),Ce(),C),Qt={key:0,class:"h-full flex justify-center items-center"},Xt=Lt(()=>e("div",{class:"text-base"},"No Booking Found",-1)),Zt=[Xt],eo={key:1,class:d(["mt-4","flex","gap-28","lg:flex-col md:gap-5 md:mt-1"])},to={class:d(["flex-1","lg:w-full relative"])},oo={class:d(["flex-1 relative"])},so={__name:"index",setup(C){const T=me(),S=fe(),u=pe(),O=_e(),m=Y(),a=h(!1),p=h({}),D=k(()=>{var t;return(t=O.params)==null?void 0:t.confirmationNo}),w=h(!1),R=t=>{const{tax_fixed_title:v,tax_percent_title:_,service_charge_title:i}=t;let c=[];_&&c.push(_),v&&c.push(v),i&&c.push(i),p.value={...p.value,taxTitle:c},(t==null?void 0:t.Payment_method)=="Card"?(m.paymentMethod.hotel=!1,t!=null&&t.link?(m.paymentMethod.link=t==null?void 0:t.link,m.paymentMethod.cardDetails=null):(m.paymentMethod.link=null,m.paymentMethod.cardDetails=t==null?void 0:t.card)):m.paymentMethod.hotel=!0},M=async()=>{var t,v,_;m.guestEmail||u.push({name:"BaseRoute::SearchBooking"}),a.value=!0;try{const c=(await Ue({email:m.guestEmail,confirmation_no:D.value})).data[0];p.value={...c,room:{name:c==null?void 0:c.room_name},plan:{rates:c==null?void 0:c.rates},selected_number_of_rooms:c.number_of_rooms,stay:(t=c.rates)==null?void 0:t.length,currency:(v=c.invoice)==null?void 0:v.currency},R(c==null?void 0:c.invoice)}catch(i){if(((_=i.response.data)==null?void 0:_.error)==="This user have an account please login."){const c='<div class="font-bold mb-1 text-base">View Booking</div>  <div>Please <a href="/login" class="text-primary">log in</a> with your registered email to view your booking.</div>';T.alertModal={state:!0,content:c},w.value=!0;return}u.push({name:"BaseRoute::SearchBooking"})}a.value=!1},j=async()=>{var t,v;m.bookingNo=D.value,a.value=!0;try{const i=(await Ae({confirmation_no:D.value})).data[0];p.value={...i,room:{name:i==null?void 0:i.room_name},plan:{rates:i==null?void 0:i.rates},selected_number_of_rooms:i.number_of_rooms,stay:(t=i.rates)==null?void 0:t.length,currency:(v=i.invoice)==null?void 0:v.currency},R(i==null?void 0:i.invoice),m.setPropertyID(i.property_id)}catch{u.push({name:"BaseRoute::ManageBooking"})}a.value=!1};return F(()=>p.value.ancillaries,t=>{t!=null&&t.length&&m.setAddons(t)},{deep:!0}),F(()=>S.isGuest,t=>{u.push({name:"BaseRoute::ManageBooking"})}),he(async()=>{S.isGuest?await M():await j()}),(t,v)=>(l(),r("div",{class:d(["bg-white px-36 pt-4 pb-16 h-full md:px-4 md:pt-1 md:bg-[#F6F6F6]",{"md:h-[100vh]":w.value}])},[w.value?(l(),r("div",Qt,Zt)):(l(),r("div",eo,[e("div",to,[a.value?(l(),z(o(ie),{key:0})):f("",!0),B(dt,{fetchedDetails:p.value},null,8,["fetchedDetails"])]),e("div",oo,[a.value?(l(),z(o(ie),{key:0})):f("",!0),B(Kt,{class:d(["w-full","lg:w-auto"]),fetchedDetails:p.value},null,8,["fetchedDetails"])])]))],2))}},xo=je(so,[["__scopeId","data-v-b649f117"]]);export{xo as default};
