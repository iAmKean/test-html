import{o as p,c as f,a as r,e as P,d as T,r as l,B as A,E as X,l as Y,R as q,i as K,u as E,C as L,h as G,j as k,n as y,t as g}from"./index-0d29c91c.js";import{a as m,b as H,f as z}from"./dateHelper-f75861f0.js";import{g as J}from"./booking-84804f94.js";import"./AppLoader.vue_vue_type_style_index_0_lang-2e650906.js";/* empty css                                                               */import{_ as O}from"./AppLoader-c0c74b58.js";import{X as Q}from"./main-044273c3.js";const W=["width","height"],Z=["stroke"],he={__name:"ico-circle-plus",props:{size:{type:[String,Number],default:"20px"},active:{type:Boolean,default:!0},color:{type:String,default:"#000000"}},setup(n){return(c,w)=>(p(),f("svg",{xmlns:"http://www.w3.org/2000/svg",width:n.size,height:n.size,viewBox:"0 0 21 21"},[r("path",{fill:"none",stroke:n.active?n.color:"#707070","stroke-linecap":"round","stroke-linejoin":"round",d:"M10 19c4.438 0 8-3.526 8-7.964C18 6.598 14.438 3 10 3c-4.438 0-8 3.598-8 8.036S5.562 19 10 19zm-4-8h8m-4 4.056V7z"},null,8,Z)],8,W))}},ee=["width","height"],te=["stroke"],ve={__name:"ico-circle-minus",props:{size:{type:[String,Number],default:"20px"},active:{type:Boolean,default:!1},color:{type:String,default:"#000000"}},setup(n){return(c,w)=>(p(),f("svg",{xmlns:"http://www.w3.org/2000/svg",width:n.size,height:n.size,viewBox:"0 0 21 21"},[r("path",{fill:"none",stroke:n.active?n.color:"#707070","stroke-linecap":"round","stroke-linejoin":"round",d:"M10 19c4.438 0 8-3.526 8-7.964C18 6.598 14.438 3 10 3c-4.438 0-8 3.598-8 8.036S5.562 19 10 19zm-4-8h8"},null,8,te)],8,ee))}},ae={class:"relative md:w-fit md:flex md:items-center sm:w-full"},se=["date"],oe={class:"font-normal text-sm leading-5"},ne={key:1,class:y(["flex","flex-col"])},le={class:"font-normal text-sm leading-5 text-black"},re=r("span",{class:"text-[10px] leading-4 font-bold date-price invisible"}," 0 ",-1),_e={__name:"index",props:{bookDate:{type:Array,default:[]}},emits:["update:displayDate","update:showCalendars","update:stayNigtht","update:bookDate"],setup(n,{emit:c}){const w=P(),x=T(),D=l(!1),i=A(),h=l([]),u=l([]),b=l([]),B=l([]),R=X(()=>i.booking),v=l([]),$=async e=>{e&&c("update:displayDate",`${z(e[0])} - ${z(e[1])}`)},F=(e=null)=>{const a=m(e);let t=u.value.find(s=>s.date===a);return t==null?void 0:t.rate},M=e=>{const a=H(m(e)),t=u.value.filter(o=>o.date.includes(a[0])||o.date.includes(a[1]));return(t.reduce(U,0)/t.length*1.15).toFixed(2)},C=async e=>{h.value=[],c("update:showCalendars",!1)},N=async e=>{if(m(e[0])===m(e[1]))await C();else if(await V(...e))await C();else if(["BaseRoute::UpdateBooking","BaseRoute::CreateBooking"].includes(x.name)){const{minStay:t,maxStay:s}=i.selectedRoom,{stay:o}=i.booking,d=l(""),_=l(!1);if(t>o&&(d.value="Does not meet the minimum stay nights for this rate.",_.value=!0),s&&s<o&&(d.value=`The maximum stay for this rate is ${s} nights.`,_.value=!0),_.value)return w.alertModal={state:!0,content:d.value},h.value=[],_.value=!1,b.value=[],0}$(e),c("update:bookDate",e),c("update:showCalendars",!1),b.value=[]},V=async(e,a)=>{const t=e<a?S(e,a):S(a,e);let s=!1;return t.forEach(o=>{if(!B.value.includes(o)){s=!0;return}}),i.booking.stay=t.length-1,s},S=(e,a)=>{const t=new Date(e.getTime()),s=[];for(;t<=a;)s.push(m(new Date(t))),t.setDate(t.getDate()+1);return s},U=(e,a)=>e+a.rate,j=async()=>{let e={};if(e={search:R.value.area,property:R.value.propertyId,number_of_rooms:i.selectedRoom.number_of_rooms},["BaseRoute::UpdateBooking","BaseRoute::CreateBooking"].includes(x.name)){const{room_id:a,rate_id:t}=i.selectedRoom;e={...e,room:a,rate:t,number_of_rooms:i.selectedRoom.selected_number_of_rooms}}try{const a=await J(e);u.value=a.data.filter(t=>t.available_rooms!==0),u.value.length?(v.value=u.value.map(t=>new Date(t.date)),B.value=u.value.map(t=>t.date)):v.value=[m(new Date(new Date().setDate(new Date().getDate()-1)))]}catch{}},I=e=>{const a=e<999999?"K":"M",t=e<999999;if(t)return(e/(t?1e3:1e6)).toFixed(2).toString().slice(-1)==="0"?(e/1e3).toFixed(1)+a:(e/1e3).toFixed(2)+a;{const s=parseInt(e/1e6),o=parseFloat(e/1e6);return(s-o===0?s:o.toFixed(1))+a}};return Y(async()=>{D.value=!0,v.value=[],await j(),D.value=!1}),q(()=>{h.value=[]}),(e,a)=>(p(),f("div",ae,[D.value?(p(),K(E(O),{key:0,opaque:""})):L("",!0),G(E(Q),{"model-value":h.value,range:"","multi-calendars":"","week-start":"1",format:"EEE MMM dd","auto-apply":"","close-on-auto-apply":!1,inline:"","min-date":new Date,"year-range":[new Date().getFullYear(),new Date().getFullYear()+100],"allowed-dates":v.value,"hide-offset-dates":"","onUpdate:modelValue":N,"calendar-class-name":"md:fit","menu-class-name":"md:fit"},{day:k(({day:t,date:s,rate:o=F(s),baseRate:d=M(s)})=>[r("div",null,[typeof o=="number"?(p(),f("div",{key:0,class:y(["flex","flex-col"]),date:o.date},[r("span",oe,g(t),1),r("span",{class:y(["text-[10px] leading-4 font-bold date-price",[{active:o<d},{invisible:typeof o!="number"}]])},g(o<1e3?o:I(o)),3)],8,se)):(p(),f("div",ne,[r("span",le,g(t),1),re]))])]),"calendar-header":k(({index:t,day:s})=>[r("div",{class:y(t===5||t===6?"text-red-500":"")},g(s),3)]),"time-picker":k(({})=>[]),_:1},8,["model-value","min-date","year-range","allowed-dates"])]))}};export{_e as _,ve as a,he as b};
