import Me from"./AppModal-b27e53ae.js";import{_ as gt}from"./AppBreadcrumbs-734e5808.js";import{c as Se,a as Ye,e as yt,s as xt,u as bt,v as Qe}from"./AppLoader.vue_vue_type_style_index_0_lang-2e650906.js";import{_ as wt}from"./_plugin-vue_export-helper-c27b6911.js";/* empty css                                                               */import{_ as De}from"./icn-intruction-cc70d524.js";import{o as i,c as d,h as x,j as Ae,a as e,u as t,f as kt,B as Ne,e as Ve,s as Le,E as K,r as y,g as J,l as Be,t as _,F as $e,k as Ce,i as Ge,C as I,n as r,b as ce,p as re,v as ye,H as Rt,y as Ee,_ as $t,L as Pe,G as Ct,z as lt,M as Xe,aw as Mt,d as St,I as Dt,J as At}from"./index-0d29c91c.js";import{_ as Ot}from"./AppLoader-c0c74b58.js";import{f as F}from"./numberHelper-25d49756.js";import{_ as Et,s as It,a as Pt,b as Tt,c as Ft,d as et,e as Nt,t as tt,f as ot,g as st}from"./BookingSummary-2ea2a3f4.js";import{a as Vt,b as Lt}from"./index.css_vue_type_style_index_0_src_true_lang-6697b8bd.js";import{_ as Re}from"./ico-chevron-f2223c49.js";import{_ as nt}from"./ico-profile-active-4985d5a2.js";import{A as Bt}from"./AppAreaCodePopup-082382bb.js";import{_ as Gt}from"./countries-d3044a4a.js";import{_ as Te,a as Fe,T as Ut,G as jt,b as Ht,c as Zt,V as qt,l as Jt}from"./stripe.esm-2907d9e2.js";import{f as Oe}from"./dateHelper-f75861f0.js";import{n as Wt,f as Kt}from"./vouchers-0dc779af.js";import{u as at,d as zt,h as Yt}from"./booking-84804f94.js";import{f as Qt}from"./loyalty-181b1cf0.js";import{u as it}from"./bookingTransactionID-1d897d48.js";import"./main-044273c3.js";import"./ico-search-65e72bb8.js";import"./voucherUnlocked-13825305.js";import"./axiosConfig-15342d77.js";const Xt={class:"flex justify-center"},eo={class:"text-14-20"},to=e("div",{class:"font-bold mt-5 text-center"},"Sign up for perks",-1),oo={class:"mt-2 flex gap-2"},so=e("div",null,"Exclusive promo vouchers",-1),ao={class:"mt-1 flex gap-2"},lo=e("div",null,"Earn and use Loyalty Points",-1),no={class:"mt-5 flex flex-col gap-3"},io={__name:"AppAccountRequired",props:{show:{type:Boolean,default:!0}},setup(E){return(L,ee)=>(i(),d("div",null,[x(Me,{show:E.show,"onUpdate:show":ee[2]||(ee[2]=a=>L.$emit("update:show",!1)),containerClass:"w-[300px] h-auto"},{default:Ae(()=>[e("div",Xt,[x(t(De))]),e("div",eo,[to,e("div",oo,[x(t(Te)),so]),e("div",ao,[x(t(Fe)),lo])]),e("div",no,[e("button",{type:"button",class:"btn btn-primary font-normal",onClick:ee[0]||(ee[0]=a=>L.$router.push({name:"BaseRoute::login",query:{redirect:L.$route.path}}))}," Login/Sign Up "),e("button",{type:"button",class:"btn btn-primary-outline",onClick:ee[1]||(ee[1]=a=>L.$emit("proceed"))}," Continue as Guest ")])]),_:1},8,["show"])]))}};const ro={class:"bg-white text-[#000000DE] md:bg-[#F6F6F6]"},co=["src"],uo={class:"flex flex-col mt-2 md:mt-4"},mo={class:"leading-6 text-[24px]"},vo={class:"font-bold leading-4 text-[10px]"},_o={class:"mt-4 flex items-center gap-4 text-[12px] leading-4 xs:block"},po={class:""},ho={class:"flex items-center gap-1 xs:mt-1"},fo={class:"text-[#046A38]"},go={key:0,class:"text-base text-danger font-bold"},yo={key:0,class:"mod_type3"},xo={key:1},bo={key:1,class:"text-base text-danger font-bold"},wo={key:0,class:"mod_type3"},ko={class:"mt-1 text-[12px] leading-4 flex items-center gap-1"},Ro=Ee('<svg id="ico-coins" xmlns="http://www.w3.org/2000/svg" width="10.49" height="10.49" viewBox="0 0 10.488 10.488"><g id="Group_13401" data-name="Group 13401"><g id="Path_7457" data-name="Path 7457"><path id="Path_7458" data-name="Path 7458" d="M5.244,10.488a5.244,5.244,0,1,1,5.244-5.244A5.25,5.25,0,0,1,5.244,10.488ZM5.244,1A4.244,4.244,0,1,0,9.488,5.244,4.249,4.249,0,0,0,5.244,1Z" fill="#fa9b1d"></path></g></g><g id="Group_13402" data-name="Group 13402"><path id="Path_7459" data-name="Path 7459" d="M7.141,8.34a.493.493,0,0,1-.233-.058L5.244,7.407l-1.663.875a.494.494,0,0,1-.527-.038.5.5,0,0,1-.2-.489L3.173,5.9,1.826,4.59A.5.5,0,0,1,2.1,3.738l1.86-.271L4.8,1.782a.519.519,0,0,1,.9,0l.832,1.685,1.861.271a.5.5,0,0,1,.276.852L7.315,5.9l.319,1.853a.5.5,0,0,1-.493.585Zm-1.9-2a.5.5,0,0,1,.233.057l1,.526L6.285,5.813A.5.5,0,0,1,6.43,5.37l.808-.788L6.12,4.419a.5.5,0,0,1-.376-.273l-.5-1.013-.5,1.013a.5.5,0,0,1-.376.273L3.25,4.582l.809.788a.5.5,0,0,1,.144.443L4.012,6.926l1-.526A.5.5,0,0,1,5.244,6.343Z" fill="#fa9b1d"></path></g></svg>',1),$o={key:0,class:"text-primary"},Co=e("span",{class:"text-[#000000DE]"},"of ",-1),Mo=e("div",{class:"border-y-[1px] mt-4"},null,-1),So={class:"mt-4"},Do=e("div",{class:"border-y-[1px] mt-4"},null,-1),Ao={class:"mt-4"},Oo=e("div",{class:"leading-6 text-[20px] font-medium"},"Select add-ons",-1),Eo={class:"mt-5 grid grid-cols-3 gap-8 md:grid-cols-2"},Io=["src"],Po={class:"md:px-2"},To=["data-tip"],Fo={class:"text-sm leading-6 font-bold mt-[10px] truncate text-left"},No={key:1,class:"text-sm leading-6 font-bold mt-[10px] truncate text-left"},Vo={class:"mt-1 text-xs"},Lo=["onClick"],Bo={key:0,class:"flex gap-2 justify-center items-center"},Go=e("span",null,"Selected",-1),Uo={key:0,xmlns:"http://www.w3.org/2000/svg",width:"10.705",height:"10.705",viewBox:"0 0 10.705 10.705"},jo=e("path",{id:"icn-selected-payment",d:"M7.353,12.705A5.353,5.353,0,1,0,2,7.353,5.353,5.353,0,0,0,7.353,12.705Zm2.48-6.218a.669.669,0,1,0-.946-.946l-2.2,2.2L5.818,6.88a.669.669,0,1,0-.946.946L6.211,9.164a.669.669,0,0,0,.946,0L9.833,6.488Z",transform:"translate(-2 -2)",fill:"#fff","fill-rule":"evenodd"},null,-1),Ho=[jo],Zo={key:1},qo={key:0,class:"flex items-center mt-[10px] justify-between border"},Jo={class:"p-1 px-3 border-r cursor-pointer xs:flex-1 xs:p-1 xs:flex xs:justify-center"},Wo={class:""},Ko={class:"mx-3 text-base"},zo={class:"py-1 px-3 border-l cursor-pointer xs:flex-1 xs:p-1 xs:flex xs:justify-center"},Yo={key:1,class:"flex gap-2 mt-1"},Qo=e("span",{class:"text-xs"},"Sorry! You have reached the max quantity for this option.",-1),Xo=e("div",{id:"hotel-addons"},null,-1),es=e("div",{class:"border-y-[1px] mt-4"},null,-1),ts={class:"shadow-2xl payment-container md:mx-[-16px]"},os=e("div",{class:r(["mt-4","py-4","px-8","flex","justify-between","items-center","bg-white","","text-xl","leading-6","font-medium"])}," Payment Option ",-1),ss={class:"flex justify-between"},as={class:"flex gap-3 items-center md:gap-2"},ls=["src"],ns={class:"flex gap-10 items-center md:gap-5"},is={class:"md:w-fit"},ds={key:0,class:"bg-[#F6F6F6] w-4 h-4 rounded-full"},rs={key:1,id:"icn-selected-payment",xmlns:"http://www.w3.org/2000/svg",width:"14.728",height:"14.355",viewBox:"0 0 14.728 14.355"},cs=e("path",{id:"icn-selected-payment-2","data-name":"icn-selected-payment",d:"M9.364,16.355a7.272,7.272,0,0,0,7.364-7.177A7.272,7.272,0,0,0,9.364,2,7.272,7.272,0,0,0,2,9.177,7.272,7.272,0,0,0,9.364,16.355Zm3.412-8.338a.881.881,0,0,0,0-1.269.937.937,0,0,0-1.3,0L8.443,9.7l-1.19-1.16a.937.937,0,0,0-1.3,0,.881.881,0,0,0,0,1.269l1.841,1.794a.937.937,0,0,0,1.3,0l3.682-3.589Z",transform:"translate(-2 -2)",fill:"#046a38","fill-rule":"evenodd"},null,-1),us=[cs],ms=["onClick"],vs={class:"flex justify-between"},_s={class:"flex gap-3 items-center md:gap-2"},ps=["src"],hs={class:"flex gap-10 items-center md:gap-2"},fs={class:"md:w-fit"},gs={key:0,class:"bg-[#F6F6F6] w-4 h-4 rounded-full"},ys={key:1,id:"icn-selected-payment",xmlns:"http://www.w3.org/2000/svg",width:"14.728",height:"14.355",viewBox:"0 0 14.728 14.355"},xs=e("path",{id:"icn-selected-payment-2","data-name":"icn-selected-payment",d:"M9.364,16.355a7.272,7.272,0,0,0,7.364-7.177A7.272,7.272,0,0,0,9.364,2,7.272,7.272,0,0,0,2,9.177,7.272,7.272,0,0,0,9.364,16.355Zm3.412-8.338a.881.881,0,0,0,0-1.269.937.937,0,0,0-1.3,0L8.443,9.7l-1.19-1.16a.937.937,0,0,0-1.3,0,.881.881,0,0,0,0,1.269l1.841,1.794a.937.937,0,0,0,1.3,0l3.682-3.589Z",transform:"translate(-2 -2)",fill:"#046a38","fill-rule":"evenodd"},null,-1),bs=[xs],ws=Ee('<div class="flex gap-3"><svg id="ico_pay_at_hotel" data-name="ico_pay at hotel" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><g id="Rectangle_624" data-name="Rectangle 624" fill="none" stroke="#046a38" stroke-width="2"><rect width="24" height="24" rx="3" stroke="none"></rect><rect x="1" y="1" width="22" height="22" rx="2" fill="none"></rect></g><g id="icn-payment-default" transform="translate(9.47 6.417)"><path id="Path_7461" data-name="Path 7461" d="M-44.554,4.233a1.361,1.361,0,0,1,1.359,1.359.452.452,0,0,0,.452.452.452.452,0,0,0,.452-.452A2.268,2.268,0,0,0-44.1,3.374V2.508a.453.453,0,0,0-.452-.452.453.453,0,0,0-.453.452v.865a2.268,2.268,0,0,0-1.811,2.218,2.266,2.266,0,0,0,2.264,2.264,1.361,1.361,0,0,1,1.359,1.36,1.361,1.361,0,0,1-1.359,1.359,1.361,1.361,0,0,1-1.36-1.359.452.452,0,0,0-.452-.452.453.453,0,0,0-.452.452,2.268,2.268,0,0,0,1.811,2.218V12.3a.452.452,0,0,0,.453.452A.452.452,0,0,0-44.1,12.3v-.866A2.268,2.268,0,0,0-42.29,9.216a2.266,2.266,0,0,0-2.264-2.264,1.361,1.361,0,0,1-1.36-1.359A1.361,1.361,0,0,1-44.554,4.233Z" transform="translate(46.973 -1.901)" fill="#046a38"></path><path id="Path_7461_-_Outline" data-name="Path 7461 - Outline" d="M-44.549,1.906a.608.608,0,0,1,.607.607v.742A2.428,2.428,0,0,1-42.13,5.6a.608.608,0,0,1-.607.607.608.608,0,0,1-.607-.607,1.206,1.206,0,0,0-1.2-1.2,1.206,1.206,0,0,0-1.205,1.2,1.206,1.206,0,0,0,1.205,1.2A2.422,2.422,0,0,1-42.13,9.22a2.427,2.427,0,0,1-1.811,2.341V12.3a.607.607,0,0,1-.607.606.608.608,0,0,1-.608-.606v-.743A2.427,2.427,0,0,1-46.968,9.22a.608.608,0,0,1,.607-.607.608.608,0,0,1,.607.607,1.206,1.206,0,0,0,1.205,1.2,1.206,1.206,0,0,0,1.2-1.2,1.206,1.206,0,0,0-1.2-1.205A2.422,2.422,0,0,1-46.968,5.6a2.428,2.428,0,0,1,1.811-2.341V2.513A.608.608,0,0,1-44.549,1.906Zm1.811,3.988a.3.3,0,0,0,.3-.3A2.116,2.116,0,0,0-44.127,3.53l-.124-.025V2.513a.3.3,0,0,0-.3-.3.3.3,0,0,0-.3.3V3.5l-.124.025A2.116,2.116,0,0,0-46.658,5.6a2.112,2.112,0,0,0,2.11,2.109A1.516,1.516,0,0,1-43.035,9.22a1.516,1.516,0,0,1-1.514,1.514A1.516,1.516,0,0,1-46.063,9.22a.3.3,0,0,0-.3-.3.3.3,0,0,0-.3.3,2.116,2.116,0,0,0,1.688,2.066l.124.025V12.3a.3.3,0,0,0,.3.3.3.3,0,0,0,.3-.3v-.993l.124-.025A2.116,2.116,0,0,0-42.44,9.22a2.112,2.112,0,0,0-2.109-2.11A1.516,1.516,0,0,1-46.063,5.6a1.516,1.516,0,0,1,1.515-1.514A1.516,1.516,0,0,1-43.035,5.6.3.3,0,0,0-42.737,5.894Z" transform="translate(46.968 -1.906)" fill="#046a38"></path></g></svg><span>Pay at Hotel</span></div>',1),ks={key:0,class:"bg-[#F6F6F6] w-4 h-4 rounded-full"},Rs={key:1,id:"icn-selected-payment",xmlns:"http://www.w3.org/2000/svg",width:"14.728",height:"14.355",viewBox:"0 0 14.728 14.355"},$s=e("path",{id:"icn-selected-payment-2","data-name":"icn-selected-payment",d:"M9.364,16.355a7.272,7.272,0,0,0,7.364-7.177A7.272,7.272,0,0,0,9.364,2,7.272,7.272,0,0,0,2,9.177,7.272,7.272,0,0,0,9.364,16.355Zm3.412-8.338a.881.881,0,0,0,0-1.269.937.937,0,0,0-1.3,0L8.443,9.7l-1.19-1.16a.937.937,0,0,0-1.3,0,.881.881,0,0,0,0,1.269l1.841,1.794a.937.937,0,0,0,1.3,0l3.682-3.589Z",transform:"translate(-2 -2)",fill:"#046a38","fill-rule":"evenodd"},null,-1),Cs=[$s],Ms={class:"flex gap-3"},Ss=Ee('<svg id="ico-pay_with_credit_card" data-name="ico-pay with credit card" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><g id="ico_pay_at_hotel" data-name="ico_pay at hotel"><g id="Rectangle_624" data-name="Rectangle 624" fill="none" stroke="#046a38" stroke-width="2"><rect width="24" height="24" rx="3" stroke="none"></rect><rect x="1" y="1" width="22" height="22" rx="2" fill="none"></rect></g></g><path id="icn-debit_credit" data-name="icn-debit/credit" d="M3,10.714H24.224M7.717,16.429H8.9m4.717,0h1.179" transform="translate(-2.018 -1)" fill="none" stroke="#046a38" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"></path></svg>',1),Ds={key:0},As={key:1},Os={key:0,class:"bg-[#F6F6F6] w-4 h-4 rounded-full"},Es={key:1,id:"icn-selected-payment",xmlns:"http://www.w3.org/2000/svg",width:"14.728",height:"14.355",viewBox:"0 0 14.728 14.355"},Is=e("path",{id:"icn-selected-payment-2","data-name":"icn-selected-payment",d:"M9.364,16.355a7.272,7.272,0,0,0,7.364-7.177A7.272,7.272,0,0,0,9.364,2,7.272,7.272,0,0,0,2,9.177,7.272,7.272,0,0,0,9.364,16.355Zm3.412-8.338a.881.881,0,0,0,0-1.269.937.937,0,0,0-1.3,0L8.443,9.7l-1.19-1.16a.937.937,0,0,0-1.3,0,.881.881,0,0,0,0,1.269l1.841,1.794a.937.937,0,0,0,1.3,0l3.682-3.589Z",transform:"translate(-2 -2)",fill:"#046a38","fill-rule":"evenodd"},null,-1),Ps=[Is],Ts=e("div",{id:"payment-option"},null,-1),Fs=e("div",{class:"border-y-[1px] mt-4"},null,-1),Ns={class:"mt-4"},Vs=e("div",{class:"text-xl leading-6 font-medium"},"Guest Details",-1),Ls={class:"mt-5 text-16-24"},Bs=e("div",{class:"border-y-[1px] mt-4"},null,-1),Gs=e("div",{class:"text-xl leading-6 font-medium"}," Cancellation Policy ",-1),Us={class:"mt-5 text-16-24"},js=["innerHTML"],Hs={key:1},Zs=e("div",{class:"border-y-[1px] mt-4"},null,-1),qs=e("div",{class:"text-xl leading-6 font-medium"},"More Info",-1),Js={class:"mt-5 text-16-24"},Ws=e("div",{class:"border-y-[1px] mt-4"},null,-1),Ks=e("div",{class:"text-xl leading-6 font-medium"},"Contact Us",-1),zs={class:"my-5 text-16-24"},Ys=e("div",null," Contact the property directly with any inquiry or special request you have. You can reach Hotel101 team here: ",-1),Qs={class:"mt-7"},Xs={class:"text-primary"},ea={class:"text-primary"},ta=e("div",{class:"border-y-[1px] mt-4"},null,-1),oa={class:"mt-8"},sa=e("div",{class:"text-xl leading-6 font-medium"},"Special Request",-1),aa=e("div",{class:"my-5 text-16-24"}," Special requests can't be guaranteed, but the property will do its best to meet your needs. ",-1),la={class:r(["flex","justify-end","mt-4","","text-12-16"])},na={__name:"HotelDetails",props:{fetchedDetails:{type:Object,default:{}}},setup(E){const L=E,ee=kt(()=>$t(()=>import("./AppRenderCKEditorContent-54b46d39.js"),["assets/AppRenderCKEditorContent-54b46d39.js","assets/index-0d29c91c.js","assets/index-4a00ec69.css","assets/AppRenderCKEditorContent-eacfeced.css"])),a=Ne(),B=Ve(),W=Le(),p=K(()=>L.fetchedDetails),o=y(!1),te=y(!1),oe=y(!1),se=y(!0),ae=y(!1),z=y(!1),ne=y(!1),H=y({hotel:!1,card:!1}),le=y([]),N=y(null),M=y(null),O=K(()=>{if(L.fetchedDetails)return It(a.selectedRoom.cancellation_days,a.selectedRoom.check_in,a.paymentMethod.hotel||!1)}),ue=async c=>{var v;te.value=!0;const u=Pe.fromFormat(c.expireDate,"MM/yy"),g=u.month,k=u.year,S=yt({creditCardNo:c.cardNumber,month:g,year:k,cvc:c.cvv,cardHolderName:c.nameCard});if(W.isGuest){var D={brand:c.cardType,last4:(v=c.cardNumber)==null?void 0:v.substr(-4),credit_card:S};a.setPaymentMethod({cardDetails:D}),H.value.hotel=!0,D.id=c.id,M.value=D,N.value=D.id,o.value=!1}else{const b=await xt(W.auth,S);b.status==200?(N.value=b.data.id,a.setPaymentMethod({cardDetails:{brand:b.data.brand.replace(/\s/g,"").toLowerCase(),last4:b.data.last4,card_id:b.data.id}}),H.value.hotel=!0,await me(),o.value=!1):B.alertModal={state:!0,content:"Please input a valid card detail."}}te.value=!1},me=async()=>{const c=await bt(W.auth);c.status==200&&(le.value=c.data)};J(()=>a.vouchers,c=>{localStorage.getItem("isClickVoucher")?f():localStorage.getItem("_IS_CLICK_REMOVE_VOUCHER")&&(f(),localStorage.removeItem("_IS_CLICK_REMOVE_VOUCHER"))},{deep:!0}),J(()=>a.selectedRoom,c=>{localStorage.getItem("_IS_DATE_CLICK")&&(f(),localStorage.removeItem("_IS_DATE_CLICK"))},{deep:!0});const G=y(0),h=y(0),f=async()=>{if(!a.selectedRoom||!a.selectedRoom.room_id||!a.selectedRoom.rate_id)return;let c=`voucher_id=${a.vouchers?a.vouchers.id:""}`,u=`number_of_rooms=${a.selectedRoom.selected_number_of_rooms?a.selectedRoom.selected_number_of_rooms:""}`,g=`room=${a.selectedRoom.room_id?a.selectedRoom.room_id:""}`,k=`rate=${a.selectedRoom.rate_id?a.selectedRoom.rate_id:""}`,S=`check_in=${a.selectedRoom.check_in?a.selectedRoom.check_in:""}`,D=`check_out=${a.selectedRoom.check_out?a.selectedRoom.check_out:""}`,v=`${c}&${u}&${g}&${k}&${S}&${D}`;try{const A=await Wt(v);if(G.value=0,A.status==200){let{data:w}=A;if(w&&w.length>0)for(var b=0;b<w.length;b++)G.value=G.value+w[b].points;else G.value=0}else G.value=0;h.value=G.value,a.selectedRoom.nightlyRatePoint=G.value}catch{}};return Be(()=>{a.guestDetails.countryCode="+63",W.isGuest||me(),setTimeout(()=>{f()},1e3)}),J(()=>L.fetchedDetails.ancillaries,c=>{c!=null&&c.length&&a.setAddons(c)},{deep:!0}),J(()=>L.fetchedDetails.invoice,c=>{c.Payment_method=="Card"?c.card.card_id&&(a.setPaymentMethod({cardDetails:c.card}),W.isGuest?a.paymentMethod.cardDetails.card_id=null:N.value=c.card.card_id):c.Payment_method=="Pay at Hotel"&&(H.value.hotel=!0,a.setPaymentMethod({hotel:!0}))},{deep:!0}),(c,u)=>{var g,k,S,D,v,b,A,w,Z,U;return i(),d("div",ro,[e("img",{class:"update-booking cursor-pointer aspect-video object-contain w-full md:rounded-md md:object-fill",src:t(p).thumbnail},null,8,co),e("div",uo,[e("div",mo,_((g=t(p))==null?void 0:g.property_name),1),e("div",vo,_((k=t(p))==null?void 0:k.city),1),e("div",_o,[e("span",po,_((S=t(p))==null?void 0:S.room_name),1),e("div",ho,[(i(!0),d($e,null,Ce(((D=t(p))==null?void 0:D.room_max_capacity)<4?(v=t(p))==null?void 0:v.room_max_capacity:4,n=>(i(),Ge(t(nt),{active:!0,size:"10",key:n}))),128)),e("span",fo,"Good for "+_((b=t(p))==null?void 0:b.room_max_capacity),1)])]),t(a).selectedRoom.discountedRate!==t(a).selectedRoom.rate?(i(),d("div",go,[t(a).vouchers&&t(a).vouchers.mod_type==3?(i(),d("div",yo,_(t(F)(t(p).currency,parseFloat(t(a).vouchers.mod_value)*t(a).selectedRoom.stay)),1)):(i(),d("div",xo,_(t(a)&&t(a).selectedRoom?t(a).selectedRoom.discountedRate:""),1))])):(i(),d("div",bo,[t(a).vouchers&&t(a).vouchers.mod_type==3?(i(),d("div",wo,_(t(F)(t(p).currency,parseFloat(t(a).vouchers.mod_value)*t(a).selectedRoom.stay)),1)):I("",!0)])),e("div",{class:r(["mt-1 text-[12px] leading-4",[t(a).vouchers&&t(a).vouchers.mod_type==3?"mt-0":""]])},[e("span",{class:r([t(a).selectedRoom.discountedRate!==t(a).selectedRoom.rate?"line-through":"text-base font-bold ",t(a).vouchers&&t(a).vouchers.mod_type==3?"line-through font-normal":"text-base"])},_(t(a).selectedRoom.rate),3),e("span",null,"/ "+_(t(a).selectedRoom.stay)+" night"+_(t(a).selectedRoom.stay>1?"s":""),1)],2),e("div",ko,[Ro,e("div",null,[ce(" Earn up to "),t(a).selectedRoom.multiplier>1?(i(),d("span",$o,[e("strong",null,_(t(a)&&t(a).selectedRoom?t(a).selectedRoom.multiplier:"")+"x ",1),Co])):I("",!0),ce(" "+_(t(F)("",parseFloat(G.value)))+" points ",1)])])]),Mo,e("div",So,[x(Ut,{checkin:t(Oe)(new Date(t(a).selectedRoom.check_in),!0),checkout:t(Oe)(new Date(t(a).selectedRoom.check_out),!0),rooms:t(a).selectedRoom.selected_number_of_rooms},null,8,["checkin","checkout","rooms"])]),Do,e("div",Ao,[Oo,e("div",Eo,[(i(!0),d($e,null,Ce((A=t(p).ancillaries)==null?void 0:A.slice(0,6),(n,he)=>{var fe;return i(),d("div",{class:"bg-white",key:he},[e("img",{class:"aspect-video object-cover md:rounded-md md:w-full",src:n.thumbnail,alt:"breakfast-icon"},null,8,Io),e("div",Po,[((fe=n.name)==null?void 0:fe.length)>16?(i(),d("div",{key:0,class:"tooltip tooltip-bottom tooltip-primary block","data-tip":n.name},[e("div",Fo,_(n.name),1)],8,To)):(i(),d("div",No,_(n.name),1)),e("div",Vo,_(t(F)(t(p).currency,n.rate)),1),e("button",{type:"button",class:r(["w-full py-2 rounded-md mt-[10px] flex gap-2 justify-center items-center text-xs",n.selected?"btn-primary":"btn-primary-outline"]),onClick:xe=>{n.selected=!n.selected,n.count=1,n.tempCount=1,n.showError=!1}},[n.selected?(i(),d("div",Bo,[Go,n.selected?(i(),d("svg",Uo,Ho)):I("",!0)])):(i(),d("span",Zo,"Select"))],10,Lo)]),n.selected&&n.max_quantity>1?(i(),d("div",qo,[e("div",Jo,[x(t(Vt),{color:"#046a38",onClick:xe=>{n.count<=1||n.count--,n!=null&&n.showError&&(n.showError=!1),n.tempCount=n.count},active:n.count!==1},null,8,["onClick","active"])]),e("div",Wo,[e("label",Ko,_(n.count),1)]),e("div",zo,[x(t(Lt),{color:"#046a38",active:n.count!==n.max_quantity,onClick:xe=>{n.tempCount++,n.count===n.max_quantity?n.count:n.count++,n.tempCount>n.max_quantity&&(n.showError=!0)}},null,8,["active","onClick"])])])):I("",!0),n!=null&&n.showError&&n.selected?(i(),d("div",Yo,[x(t(Et),{size:"15px",class:"w-[30px]"}),Qo])):I("",!0)])}),128))])]),Xo,es,e("div",ts,[os,e("div",{class:r(["bg-[#F6F6F6] pt-8 px-8 pb-8 xs:px-4 xs:py-4",{"opacity-50 pointer-events-none":t(a).selectedRoom.isBookingChange?t(a).selectedRoom.isBookingChange===0||t(a).selectedRoom.isBookingChange===2:!0},{"opacity-50 pointer-events-none":((w=t(p).invoice)==null?void 0:w.Payment_method)=="Pay at Hotel"}])},[M.value&&t(W).isGuest&&t(p).invoice&&t(p).invoice.Payment_method=="Card"?(i(),d("div",{key:0,class:"bg-white card p-5 rounded-none text-[15px] leading-[19px] text-[#272727] mb-8 xs:p-4 xs:mb-4 xs:px-2",onClick:u[0]||(u[0]=n=>{N.value=M.value.id,H.value.hotel=!1,H.value.card=!1,t(a).setPaymentMethod({cardDetails:{brand:M.value.brand,last4:M.value.last4,credit_card:M.value.credit_card}})})},[e("div",ss,[e("div",as,[e("img",{class:"w-6",src:t(Se)(M.value.brand)},null,8,ls),e("span",null,_(t(Ye)(M.value.brand)),1)]),e("div",ns,[e("div",is," *** "+_(M.value.last4),1),M.value.id!=N.value?(i(),d("div",ds)):(i(),d("svg",rs,us))])])])):I("",!0),!t(W).isGuest&&t(p).invoice&&t(p).invoice.Payment_method=="Card"?(i(!0),d($e,{key:1},Ce(le.value,(n,he)=>(i(),d("div",{class:"bg-white card p-5 rounded-none text-[15px] leading-[19px] text-[#272727] mb-8 xs:p-4 xs:mb-4 xs:px-2",key:he,onClick:fe=>{N.value=n.id,H.value.hotel=!1,H.value.card=!1,t(a).setPaymentMethod({cardDetails:{brand:n.brand.replace(/\s/g,"").toLowerCase(),last4:n.last4,card_id:n.id}})}},[e("div",vs,[e("div",_s,[e("img",{class:"w-6",src:t(Se)(n.brand.replace(/\s/g,"").toLowerCase())},null,8,ps),e("span",null,_(t(Ye)(n.brand.replace(/\s/g,"").toLowerCase())),1)]),e("div",hs,[e("div",fs,"*** "+_(n.last4),1),n.id!=N.value?(i(),d("div",gs)):(i(),d("svg",ys,bs))])])],8,ms))),128)):I("",!0),t(p).invoice&&t(p).invoice.Payment_method=="Pay at Hotel"?(i(),d("div",{key:2,class:"bg-white flex items-center justify-between p-5",onClick:u[1]||(u[1]=n=>{H.value.hotel=!0,H.value.card=!1,N.value=null,t(a).setPaymentMethod({hotel:!0})})},[ws,H.value.hotel?(i(),d("svg",Rs,Cs)):(i(),d("div",ks))])):I("",!0),t(p).invoice&&t(p).invoice.Payment_method=="Card"&&le.value.length<10?(i(),d("div",{key:3,class:"my-8 bg-white flex items-center justify-between p-5",onClick:u[2]||(u[2]=n=>o.value=!0)},[e("div",Ms,[Ss,!t(W).isGuest&&le.value.length>1?(i(),d("span",Ds,"New Credit Card")):(i(),d("span",As,"Pay with Credit Card"))]),H.value.card?(i(),d("svg",Es,Ps)):(i(),d("div",Os))])):I("",!0)],2)]),Ts,Fs,e("div",Ns,[e("div",{class:"mt-4 flex justify-between items-center",onClick:u[3]||(u[3]=n=>se.value=!se.value)},[Vs,x(t(Re),{height:"14",width:"17",color:"#046A38",direction:se.value?"up":"down"},null,8,["direction"])]),re(e("div",Ls,[x(jt)],512),[[ye,se.value]])]),Bs,e("div",null,[e("div",{class:"mt-4 flex justify-between items-center",onClick:u[4]||(u[4]=n=>oe.value=!oe.value)},[Gs,x(t(Re),{height:"14",width:"17",color:"#046A38",direction:oe.value?"up":"down"},null,8,["direction"])]),re(e("div",Us,[((Z=t(p))==null?void 0:Z.refund_policy)===1?(i(),d("span",{key:0,innerHTML:t(O)},null,8,js)):(i(),d("span",Hs," If you cancel, this booking is non-refundable. "))],512),[[ye,oe.value]])]),Zs,e("div",null,[e("div",{class:"mt-4 flex justify-between items-center",onClick:u[5]||(u[5]=n=>ae.value=!ae.value)},[qs,x(t(Re),{height:"14",width:"17",color:"#046A38",direction:ae.value?"up":"down"},null,8,["direction"])]),re(e("div",Js,[x(t(ee),{htmlContent:t(p).more_info||""},null,8,["htmlContent"])],512),[[ye,ae.value]])]),Ws,e("div",null,[e("div",{class:"mt-4 flex justify-between items-center",onClick:u[6]||(u[6]=n=>z.value=!z.value)},[Ks,x(t(Re),{height:"14",width:"17",color:"#046A38",direction:z.value?"up":"down"},null,8,["direction"])]),re(e("div",zs,[Ys,e("div",Qs,[ce(" Phone Number : "),e("span",Xs,_(t(p).contact||"N/A"),1)]),e("div",null,[ce(" Email: "),e("span",ea,_(t(p).email||"N/A"),1)])],512),[[ye,z.value]])]),ta,e("div",oa,[sa,aa,re(e("textarea",{"onUpdate:modelValue":u[7]||(u[7]=n=>t(a).additionalNotes=n),placeholder:"Input additional notes",maxlength:"500",class:r(["w-full","border","focus-visible:outline-[#046A38]","px-2","py-3","rounded-lg"]),rows:"4"},null,512),[[Rt,t(a).additionalNotes]]),e("div",la,_(((U=t(a).additionalNotes)==null?void 0:U.length)??0)+"/500 ",1)]),x(t(Bt),{show:ne.value,"onUpdate:code":u[8]||(u[8]=n=>t(a).guestDetails.countryCode=n),"onUpdate:show":u[9]||(u[9]=n=>ne.value=n)},null,8,["show"]),x(t(Gt),{show:o.value,saving:te.value,"onUpdate:show":u[10]||(u[10]=n=>o.value=n),"onUpdate:code":u[11]||(u[11]=n=>ue(n))},null,8,["show","saving"])])}}},ia={class:r(["shadow-lg"," flex","flex-col","rounded-lg md:shadow-xl bg-white"])},da={class:r(["px-[11px]","mt-[13px]","text-2xl","leading-6",""])},ra={class:r(["mt-[11px]","py-2","bg-[#E3F3E6]","px-8","flex","gap-3","items-start","md:px-5"])},ca={class:"break-all"},ua={class:"flex items-center gap-[4.21px] whitespace-nowrap"},ma={class:r(["px-8","mt-[18px]"])},va={class:r(["flex"])},_a={class:"flex-1"},pa=e("div",{class:"text-14-24 font-bold"},"Check-in",-1),ha={key:0,class:"text-14-20"},fa={class:"flex-1"},ga=e("div",{class:"text-14-24 font-bold"},"Check-out",-1),ya={key:0,class:"text-14-20"},xa={class:"flex items-start gap-1"},ba=Ee('<svg id="ico-coins" xmlns="http://www.w3.org/2000/svg" width="15" height="15" viewBox="0 0 10.488 10.488"><g id="Group_13401" data-name="Group 13401"><g id="Path_7457" data-name="Path 7457"><path id="Path_7458" data-name="Path 7458" d="M5.244,10.488a5.244,5.244,0,1,1,5.244-5.244A5.25,5.25,0,0,1,5.244,10.488ZM5.244,1A4.244,4.244,0,1,0,9.488,5.244,4.249,4.249,0,0,0,5.244,1Z" fill="#fa9b1d"></path></g></g><g id="Group_13402" data-name="Group 13402"><path id="Path_7459" data-name="Path 7459" d="M7.141,8.34a.493.493,0,0,1-.233-.058L5.244,7.407l-1.663.875a.494.494,0,0,1-.527-.038.5.5,0,0,1-.2-.489L3.173,5.9,1.826,4.59A.5.5,0,0,1,2.1,3.738l1.86-.271L4.8,1.782a.519.519,0,0,1,.9,0l.832,1.685,1.861.271a.5.5,0,0,1,.276.852L7.315,5.9l.319,1.853a.5.5,0,0,1-.493.585Zm-1.9-2a.5.5,0,0,1,.233.057l1,.526L6.285,5.813A.5.5,0,0,1,6.43,5.37l.808-.788L6.12,4.419a.5.5,0,0,1-.376-.273l-.5-1.013-.5,1.013a.5.5,0,0,1-.376.273L3.25,4.582l.809.788a.5.5,0,0,1,.144.443L4.012,6.926l1-.526A.5.5,0,0,1,5.244,6.343Z" fill="#fa9b1d"></path></g></svg>',1),wa={key:0,class:"text-primary"},ka=e("span",{class:"text-[#000000DE]"},"of ",-1),Ra=e("div",{class:"mt-4 border-y-[1px]"},null,-1),$a={class:"xs:ml-[10px]"},Ca=e("div",{class:r(["font-bold","text-14-24",""])}," My Voucher ",-1),Ma={class:r(["font-medium","text-12-16","","text-primary","cursor-pointer"])},Sa={key:0,class:"text-14-16 text-black cursor-auto"},Da={key:1},Aa={key:0,class:"flex gap-[10.27px]"},Oa=e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14.73",height:"14.73",viewBox:"0 0 10.705 10.705"},[e("path",{id:"icn-selected-payment",d:"M7.353,12.705A5.353,5.353,0,1,0,2,7.353,5.353,5.353,0,0,0,7.353,12.705Zm2.48-6.218a.669.669,0,1,0-.946-.946l-2.2,2.2L5.818,6.88a.669.669,0,1,0-.946.946L6.211,9.164a.669.669,0,0,0,.946,0L9.833,6.488Z",transform:"translate(-2 -2)",fill:"#046A38","fill-rule":"evenodd"})],-1),Ea={class:"truncate xs:w-[75%]"},Ia={key:0,class:r(["text-12-16",""])},Pa=e("path",{id:"icn-exit",d:"M4.293,4.293a1,1,0,0,1,1.414,0L10,8.586l4.293-4.293a1,1,0,1,1,1.414,1.414L11.414,10l4.293,4.293a1,1,0,1,1-1.414,1.414L10,11.414,5.707,15.707a1,1,0,1,1-1.414-1.414L8.586,10,4.293,5.707a1,1,0,0,1,0-1.414Z",transform:"translate(-4 -4)",fill:"#707070","fill-rule":"evenodd"},null,-1),Ta=[Pa],Fa={key:1},Na={class:r(["flex","gap-[10px]","items-center"])},Va=e("div",{class:r(["font-bold","text-14-24",""])}," Redeem Points ",-1),La={class:r(["font-medium","text-12-16",""])},Ba={key:0,class:"text-14-16 text-black cursor-auto"},Ga={key:0,class:"flex items-end"},Ua={class:"relative inline-flex items-center cursor-pointer"},ja=["disabled"],Ha=["disabled"],Za=e("div",{class:"w-11 h-6 bg-gray-200 peer-focus:outline-nonedark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-[#046A38]"},null,-1),qa={class:r(["px-4 py-2","flex","items-center","justify-between","hover:bg-[#E3F3E6]"])},Ja={class:r(["flex","gap-[10px]","items-center"])},Wa=e("div",{class:r(["font-bold","text-14-24",""])},"Add-ons",-1),Ka=e("div",null,[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14.73",height:"14.73",viewBox:"0 0 10.705 10.705"},[e("path",{id:"icn-selected-payment",d:"M7.353,12.705A5.353,5.353,0,1,0,2,7.353,5.353,5.353,0,0,0,7.353,12.705Zm2.48-6.218a.669.669,0,1,0-.946-.946l-2.2,2.2L5.818,6.88a.669.669,0,1,0-.946.946L6.211,9.164a.669.669,0,0,0,.946,0L9.833,6.488Z",transform:"translate(-2 -2)",fill:"#046A38","fill-rule":"evenodd"})])],-1),za={class:"w-[calc(100vw/4)] md:w-[60vw]"},Ya={class:"truncate"},Qa={key:0,class:r(["text-12-16",""])},Xa={class:r(["px-4 py-2","flex","items-center","justify-between","hover:bg-[#E3F3E6]"])},el={class:r(["flex","gap-[10px]","items-center"])},tl=e("div",{class:r(["font-bold","text-14-24",""])}," Payment Option ",-1),ol={key:0},sl={key:1},al={key:0,class:r(["text-12-16",""])},ll={key:1,class:r(["flex items-center gap-1 text-12-16",""])},nl=["src"],il={key:2,class:r(["text-12-16",""])},dl={class:"hidden xs:block w-full"},rl=e("div",{class:r(["font-bold","text-14-24",""])}," Amount to Pay ",-1),cl={class:r(["font-bold","text-14-24",""])},ul={class:"mt-2"},ml=e("div",{class:r(["font-medium","text-[13px] leading-4",""])}," Original Price ",-1),vl={class:r(["font-medium mt-1","text-[13px] leading-4","w-full text-left line-through"])},_l={key:0,class:"mt-2"},pl=e("div",{class:r(["font-medium","text-[13px] leading-4","mt-1"])}," Remaining Balance ",-1),hl={class:r(["font-medium mt-1","text-[13px] leading-4","w-full text-left mt-1"])},fl={key:1,class:"mt-2"},gl=e("div",{class:r(["font-medium","text-[13px] leading-4","mt-1"])}," Refundable ",-1),yl={class:r(["font-medium mt-1","text-[13px] leading-4","w-full text-left mt-1"])},xl=e("div",{class:r(["mt-2 text-center xs:mt-2","font-medium","text-12-16","","text-primary","cursor-pointer"])}," View booking summary ",-1),bl=e("div",{class:r(["font-bold","text-14-24",""])}," Amount to Pay ",-1),wl=e("div",{class:r(["font-medium","text-[13px] leading-4",""])}," Original Price ",-1),kl={key:0,class:r(["font-medium","text-[13px] leading-4","mt-1"])},Rl={key:1,class:r(["font-medium","text-[13px] leading-4","mt-1"])},$l=e("div",{class:r(["mt-2","font-medium","text-12-16","","text-primary","cursor-pointer"])}," View booking summary ",-1),Cl={class:"xs:hidden flex items-start flex-col justify-end"},Ml={class:r(["font-bold","text-14-24",""])},Sl={class:r(["font-medium","text-[13px] leading-4","w-full text-right line-through"])},Dl={key:0,class:r(["font-medium","text-[13px] leading-4","w-full text-right mt-1"])},Al={key:1,class:r(["font-medium","text-[13px] leading-4","w-full text-right mt-1"])},Ol=["disabled"],El=e("span",null,"Update Booking",-1),Il=[El],Pl={class:"flex justify-center"},Tl={class:"text-14-20 mt-5"},Fl=e("div",{class:"font-bold"},"Guest Details are required.",-1),Nl=e("div",null,[ce(" Please enter a valid email address "),e("br"),ce(" or Login/Sign Up to proceed ")],-1),Vl=e("div",{class:"font-bold mt-5"},"Sign up for perks",-1),Ll={class:"mt-2 flex gap-2"},Bl=e("div",null,"Exclusive promo vouchers",-1),Gl={class:"mt-1 flex gap-2"},Ul=e("div",null,"Earn and use Loyalty Points",-1),jl={class:"mt-10 flex flex-col"},Hl={class:"text-14-20 mt-5"},Zl={class:"flex justify-center"},ql={class:"mt-5"},Jl={class:"mt-10 flex flex-col"},Wl={__name:"Summary",props:{fetchedDetails:{type:Object,default:{}}},setup(E){const L=E,ee=Ct.STRIPE_KEY;var a=null;const B=Le(),W=lt(),p=Ve(),o=Ne(),te=y(!1),oe=y(!1),se=it(),ae=y(!1),z=y(!1),ne=y(""),H=y(""),le=y(!1),N=y(!1),M=y(!1),O=K(()=>o.selectedRoom),ue=y(!1),me=K(()=>{var l;return!((l=o.guestDetails)!=null&&l.length)}),G=K(()=>Ft(o.addOns)),h=K(()=>et(O.value)),f=()=>{let l=R.value;return et({plan:{rates:l},selected_number_of_rooms:O.value.selected_number_of_rooms})},c=K(()=>Nt(o.addOns,O.value)*O.value.selected_number_of_rooms),u=K(()=>{var l=0;if(o.vouchers){if(o.vouchers.booking_discount)return parseFloat(o.vouchers.booking_discount);o.vouchers.mod_type==2?l=k.value*(o.vouchers.mod_value/100):l=Number(o.vouchers.mod_value)}return!l&&(M.value=!1),parseFloat(l.toFixed(2))}),g=y(0),k=K(()=>tt(h.value,c.value)),S=()=>tt(f(),c.value),D=y(!1),v=K(()=>{if(!w.value)return 0;const{total_payable:l}=w.value;return D.value?ot(isNaN(h.value)?0:h.value,isNaN(c.value)?0:c.value,isNaN(u.value)?0:u.value,isNaN(g.value)?0:g.value,isNaN(w.value.refunded)?0:w.value.refunded):parseFloat(l)}),b=()=>{if(!w.value)return 0;const{total_payable:l}=w.value;return D.value?ot(f(),c.value,0,g.value,w.value.refunded):parseFloat(l)},A=K(()=>{if(o.vouchers&&o.vouchers.mod_type==3){let P=b();if(P=P||P==0?P+"":void 0,!P)return 0;let T=w.value;if(T=T||T==0?T+"":void 0,!T)return 0;const Q=parseFloat(b().toFixed(2)),C=parseFloat(w.value.total_payable.toFixed(2));let X=0;return Q>C?X=1:Q<C?X=2:X=0,X}let l=v.value;if(l=l||l==0?l+"":void 0,!l)return 0;let s=w.value;if(s=s||s==0?s+"":void 0,!s)return 0;const m=parseFloat(v.value.toFixed(2)),j=parseFloat(w.value.total_payable.toFixed(2));return m>j?1:m<j?2:0}),w=K(()=>L.fetchedDetails.invoice),Z=y(0),U=async(l=!1)=>{if(!(o.booking&&o.booking.propertyId))return;if(o.vouchers&&o.vouchers.mod_type==3){if(Number.isNaN(S()))return}else if(Number.isNaN(k.value))return;let s=o.vouchers&&o.vouchers.mod_type==3?S():k.value;if(s==0){Z.value=0,o.selectedRoom.fetchedPoints=0,g.value=0;return}const m={total:s,propertyId:o.booking.propertyId};try{const j=await Qt(m);let{currency_value:P}=j.data;s<P?(Z.value=o.selectedRoom.fetchedPoints=s,l&&M.value&&(g.value=s)):(Z.value=o.selectedRoom.fetchedPoints=P||0,l&&M.value&&(g.value=P||0))}catch{}},n=K(()=>{if(!w.value)return 0;const{tax_percent:l,tax_fixed:s,service_charge:m}=w.value;return st(v.value,l,s,m)}),he=()=>{if(!w.value)return 0;const{tax_percent:l,tax_fixed:s,service_charge:m}=w.value;return st(b(),l,s,m)},fe=async()=>{var Q;let l=[];if(o.vouchers&&o.vouchers.mod_type==3)for(var s=0;s<R.value.length;s++)l.push({date:R.value[s].date,rate:R.value[s].rate,base_rate:R.value[s].base_rate});else l=(Q=O.value.plan)==null?void 0:Q.rates.map(C=>({date:C.date,rate:C.discount_rate??C.rate,base_rate:C.rate}));const{room_id:m,rate_id:j}=o.selectedRoom,P=o.addOns.filter(C=>C.selected).map(C=>({ancillary_id:C.id,unit_rate:C.rate,quantity:C.count,number_of_rooms:o.selectedRoom.selected_number_of_rooms})),T={rate_id:j,room_id:m,number_of_rooms:o.selectedRoom.selected_number_of_rooms,check_in:o.selectedRoom.check_in,check_out:o.selectedRoom.check_out,ancillaries:P,rates:l,guest_list:o.guestDetails,total:o.vouchers&&o.vouchers.mod_type==3?S():k.value,total_payable:o.vouchers&&o.vouchers.mod_type==3?b():v.value,note:o.additionalNotes,from:"web",points_to_redeem:g.value};return o.vouchers&&(T.voucher_id=o.vouchers.id,T.voucher_discount=o.vouchers&&o.vouchers.mod_type==3?0:u.value),o.paymentMethod.hotel?T.payment_method="1":(T.payment_method="2",o.paymentMethod.cardDetails.card_id?o.paymentMethod.cardDetails.cvv?T.saved_card={id:o.paymentMethod.cardDetails.card_id,cvc:o.paymentMethod.cardDetails.cvv}:o.paymentMethod.cardDetails.card_id=null:o.paymentMethod.cardDetails.credit_card&&(T.credit_card=o.paymentMethod.cardDetails.credit_card)),T},xe=async()=>{if(me.value)p.alertModal={state:!0,content:"Please input  at least 1 guest detail."};else{if(await Ze()){p.alertModal={state:!0,content:"Your voucher is expired."};return}if(!await ct()){p.alertModal={state:!0,content:"No changes have been made."};return}if(B.isGuest){le.value=!0;return}if(A.value===2||A.value===0){await ge();return}if(!(o.paymentMethod.hotel||o.paymentMethod.cardDetails&&(o.paymentMethod.cardDetails.card_id||o.paymentMethod.cardDetails.credit_card))){be("payment-option"),p.alertModal={state:!0,content:"Please update your card."};return}o.paymentMethod.cardDetails&&o.paymentMethod.cardDetails.card_id?oe.value=!0:await ge()}},dt=()=>{if(ae.value=!1,!B.isGuest)W.replace("/booking");else{const s='<div class="font-bold mb-1 text-base">View Booking</div>  <div>Please <a href="/login" class="text-primary">log in</a> with your registered email to view your booking.</div>';p.alertModal={state:!0,content:s}}const l=W.history;l&&(l.stacks.pop(),l.index--)},rt=async()=>{if(A.value===2||A.value===0){await ge();return}if(!(o.paymentMethod.hotel||o.paymentMethod.cardDetails&&(o.paymentMethod.cardDetails.card_id||o.paymentMethod.cardDetails.credit_card))){be("payment-option"),p.alertModal={state:!0,content:"Please update your card."};return}o.paymentMethod.cardDetails&&o.paymentMethod.cardDetails.card_id?oe.value=!0:await ge()},ct=async()=>{var $,We,Ke,ze;const{total_payable:l}=w.value;let s=JSON.parse(o.selectedRoom.guestDetailsOld),m=o.guestDetails;const j=Date.parse(($=L.fetchedDetails)==null?void 0:$.check_in),P=Date.parse((We=L.fetchedDetails)==null?void 0:We.check_out),T=Date.parse((Ke=o.selectedRoom)==null?void 0:Ke.check_in),Q=Date.parse((ze=o.selectedRoom)==null?void 0:ze.check_out);let C=V.value=="3"?b():v.value,X=l.toFixed(2);const ie=parseFloat(X)===parseFloat(C.toFixed(2)),de=o.selectedRoom.note===o.additionalNotes,ve=JSON.stringify(m).length===JSON.stringify(s).length;return!(ie&&de&&ve&&j===T&&P===Q)},_e=y(!1),ge=async()=>{var j,P,T,Q;_e.value=!0;const l=await fe();N.value=!0;let s=null;se.bookingTransactionID||z.value?s=se.bookingTransactionID:ne.value!=""&&(s=ne.value),l.transaction_id=s;try{const C=await at(L.fetchedDetails.booking_id,l);let{transaction_id:X}=C.data;if(se.bookingTransactionID=X,z.value||(ne.value=X||""),z.value=!0,!C.data.id){a.handleNextAction({clientSecret:C.data.client_secret}).then(async function(ie){var de="Something went wrong. Please try again.";ie.error?(ie.error.code=="payment_intent_authentication_failure"?de="Authentication/OTP has failed. Please try again.":de=Qe(ie.error.message),p.alertModal={state:!0,content:de},N.value=!1):setTimeout(async()=>{delete l.credit_card,delete l.saved_card,l.intent=ie.paymentIntent.id;try{const pe=await at(L.fetchedDetails.booking_id,l);je(pe)}catch{var ve="Something went wrong. Please try again.";p.alertModal={state:!0,content:ve||""}}N.value=!1},1500)});return}je(C)}catch(C){var m="Something went wrong. Please try again.";(j=C.response)!=null&&j.data&&((P=C.response)!=null&&P.data.errors?m=C.response.data.errors:m=Qe((T=C.response)==null?void 0:T.data.error)),((Q=C.response)==null?void 0:Q.status)===442?C.response.data.error=="This transaction has already been made. Please check your booking."?(H.value="Your booking is already confirmed. Please go to My Bookings for your booking details.",ae.value=!0):p.alertModal={state:!0,content:m}:p.alertModal={state:!0,content:m}}N.value=!1,z.value=!1,_e.value=!1},je=l=>{B.isGuest&&(o.guestEmail=o.guestDetails[0].guest_email),N.value=!1;const{booking_no:s}=l.data;o.bookedDetails={pointsEarned:null,hotelName:null,isFromUpdateBooking:!0},o.bookingNo=s,ut(),W.push({name:"BaseRoute::success"})},ut=()=>{o.selectedRoom={},o.addOns=[],o.paymentMethod.hotel=!1,o.additionalNotes=""},mt=async l=>{const s=await Kt(l);if(s.status==200){var m=s.data;m.booking_discount=parseFloat(w.value.voucher_discount),o.vouchers=m}},He=()=>{if(o.vouchers){const l=Date.parse(o.vouchers.checkin_start),s=Date.parse(o.vouchers.checkin_end),m=Date.parse(o.selectedRoom.check_in+" 00:00:00"),j=Date.parse(o.selectedRoom.check_out+" 00:00:00");(m<l||j>s)&&(ke(q.value?q.value.mod_type:"","",!1)||(Y.value&&Y.value.mod_type===3?o.vouchers=Y.value:o.vouchers=null))}},Ze=async()=>{if(o.vouchers){const l=Pe.fromSQL(o.vouchers.validity_end);let s=new Date(Pe.now());s.setHours(0,0,0,0);let m=new Date(l);return m.setHours(0,0,0,0),s<m?!1:s>m}},vt=async()=>{a=await Jt(ee)},be=l=>{const s=document.getElementById(l);s&&s.scrollIntoView({behavior:"smooth",block:"end"})},_t=()=>{if(o.paymentMethod.hotel)p.alertModal={state:!0,content:"Cannot change the payment method."};else{if(A.value!==0&&A.value!==2)return;p.alertModal={state:!0,content:"Can't change the card details. There is no update made on the booking."}}},pt=async()=>await Ze()?(p.alertModal={state:!0,content:"Sorry, you cannot update this booking because you are using an Expired Fixed Price voucher."},!0):!1,q=y(),Y=y();Be(async()=>{q.value=localStorage.getItem("_CURRENTVOUCHER_FROM_VIEW")?JSON.parse(localStorage.getItem("_CURRENTVOUCHER_FROM_VIEW")):null,Y.value=localStorage.getItem("_CURRENTVOUCHER_FROM_VIEW")?JSON.parse(localStorage.getItem("_CURRENTVOUCHER_FROM_VIEW")):null,q.value&&q.value.mod_type===3&&setTimeout(()=>{pt()},750),z.value=!1,ne.value="",vt(),o.voucherState=!1,o.selectedRoom.isBookingChange=0}),J(()=>L.fetchedDetails.invoice,l=>{if(!_e.value){if(l.voucher_id&&mt(l.voucher_id),M.value=!0,typeof l.points_redeemed=="string"){if(l.points_redeemed==="0.00")return;g.value=Z.value=parseFloat(l.points_redeemed);return}M.value=!1,!B.isGuest&&U()}},{deep:!0});const qe=y(0),Je=y();J(()=>k.value,l=>{qe.value++,qe.value===4&&(D.value=!0),localStorage.getItem("isClickVoucher")||ke(q.value?q.value.mod_type:"","",!1)||(Y.value&&Y.value.mod_type===3?o.vouchers=Y.value:o.vouchers=null),!_e.value&&(M.value=!1,!B.isGuest&&setTimeout(()=>{U()},350))}),J(()=>o.selectedRoom.check_in,()=>{He()}),J(()=>o.selectedRoom.check_out,()=>{He()}),J(()=>G.value,()=>{clearTimeout(Je.value),Je.value=setTimeout(()=>{D.value=!0},2500)},{deep:!0}),J(()=>o.selectedRoom.isConfirmBtnDisabled,l=>{l&&(D.value=!0)},{deep:!0}),J(()=>M.value,l=>{if(l){let s=V.value=="3"?b():v.value,m=parseFloat(Z.value.toFixed(2));s<m?g.value=s:g.value=m}else g.value=0}),J(()=>A.value,l=>{o.selectedRoom.isBookingChange=l});const V=y(""),we=y(""),R=y([]);J(()=>o.vouchers,(l,s)=>{if(l){if(R.value=[],V.value=l.mod_type+"",we.value=l.mod_value,R.value=localStorage.getItem("_ROOMRATES")?JSON.parse(localStorage.getItem("_ROOMRATES")):[],V.value=="3"){if(R.value.length>0)for(var m=0;m<R.value.length;m++)R.value[m].rate=parseFloat(we.value),R.value[m].discount_rate=null}else if(R.value.length>0)for(var m=0;m<R.value.length;m++)R.value[m].rate=R.value[m].rate}else V.value="";q.value=localStorage.getItem("_CURRENTVOUCHER_FROM_VIEW")?JSON.parse(localStorage.getItem("_CURRENTVOUCHER_FROM_VIEW")):null,localStorage.getItem("isClickVoucher")?(localStorage.setItem("_ROOMRATES",JSON.stringify(R.value)),U(!0),setTimeout(()=>{localStorage.removeItem("isClickVoucher")},250)):U(!1)}),J(()=>q.value,(l,s)=>{Y.value&&Y.value.mod_type===3&&(q.value||(q.value=Y.value,o.vouchers=q.value))}),J(()=>o.selectedRoom,(l,s)=>{if(l&&(R.value=[],o.vouchers&&o.vouchers.mod_type===3&&(R.value=localStorage.getItem("_ROOMRATES")?JSON.parse(localStorage.getItem("_ROOMRATES")):[],R.value.length>0)))for(var m=0;m<R.value.length;m++)R.value[m].rate=parseFloat(we.value),R.value[m].discount_rate=null;_e.value||(ke(q.value?q.value.mod_type:"","",!1)||(Y.value&&Y.value.mod_type===3?o.vouchers=Y.value:o.vouchers=null),M.value=!1,U())});const ht=()=>{let l=localStorage.getItem("_ORIGINAL_ROOMRATES")?JSON.parse(localStorage.getItem("_ORIGINAL_ROOMRATES")):[];if(l&&l.length>0){if(R.value.length>0)for(var s=0;s<R.value.length;s++)o.vouchers&&o.vouchers.mod_type==3?(R.value[s].rate=R[s].base_rate,R.value[s].discount_rate=null):(R.value[s].rate=R.value[s].rate,R.value[s].discount_rate=null);else R.value=l;setTimeout(()=>{localStorage.setItem("_ROOMRATES",JSON.stringify(R.value)),o.selectedRoom&&o.selectedRoom.plan&&(o.selectedRoom.plan.rates=R)},150)}},ft=()=>{ke(q.value?q.value.mod_type:"","Sorry, you can't remove fixed voucher during an update.")||(ht(),_e.value=!1,M.value=!1,o.vouchers=null,localStorage.setItem("_IS_CLICK_REMOVE_VOUCHER","1"))},ke=(l,s="",m=!0)=>l&&l===3?(m&&(p.alertModal={state:!0,content:s}),!0):!1;return(l,s)=>{var m,j,P,T,Q,C,X,ie,de,ve,pe,Ie;return i(),d("div",ia,[e("div",da,_(t(O)&&t(O).property_name?t(O).property_name:"")+" ",1),e("div",ra,[e("span",ca,_((m=t(O))==null?void 0:m.room_name),1),e("div",ua,[(i(!0),d($e,null,Ce(((j=E.fetchedDetails)==null?void 0:j.room_max_capacity)<4?(P=E.fetchedDetails)==null?void 0:P.room_max_capacity:4,$=>(i(),Ge(t(nt),{active:!0,size:"10",key:$}))),128)),e("span",null,"Good for "+_((T=E.fetchedDetails)==null?void 0:T.room_max_capacity),1)])]),e("div",ma,[e("div",va,[e("div",_a,[pa,t(O).check_in?(i(),d("div",ha,_(t(Oe)(new Date(t(O).check_in),!0)),1)):I("",!0)]),e("div",fa,[ga,t(O).check_out?(i(),d("div",ya,_(t(Oe)(new Date(t(O).check_out),!0)),1)):I("",!0)])]),e("div",{class:r(["flex","mt-3","text-12-16","","gap-[6.51px]","items-start"])},[e("div",null,_(t(O).stay)+" night"+_(t(O).stay>1?"s":""),1),e("div",xa,[ba,e("div",null,[e("div",null,[ce(" Earn up to "),t(O)&&t(O).multiplier>1?(i(),d("span",wa,[e("strong",null,_(t(O).multiplier)+"x ",1),ka])):I("",!0),ce(" "+_(t(F)("",parseFloat(t(o).selectedRoom.nightlyRatePoint)))+" points ",1)]),re(e("div",null," Points accessible for registered users only ",512),[[ye,t(B).isGuest]])])])],2)]),Ra,e("div",{class:r(["px-4 py-2","flex","items-center","justify-between","hover:bg-[#E3F3E6]",{"opacity-50":t(B).isGuest}])},[e("div",{class:r([["flex","gap-[10px]","items-center"],"xs:gap-0 xs:w-[90%]"])},[x(t(Te),{class:"min-w-[24px]"}),e("div",$a,[Ca,e("div",Ma,[t(B).isGuest?(i(),d("span",Sa," Accessible for registered users only ")):(i(),d("div",Da,[t(o).vouchers?(i(),d("div",Aa,[Oa,e("span",Ea,_((Q=t(o).vouchers)==null?void 0:Q.code),1)])):(i(),d("div",{key:1,onClick:s[0]||(s[0]=$=>t(o).voucherState=!0)}," Select or Enter Code "))]))])])]),t(B).isGuest?I("",!0):(i(),d("div",Ia,[t(o).vouchers?(i(),d("svg",{key:0,xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 12 12",class:"cursor-pointer",onClick:s[1]||(s[1]=$=>{ft()})},Ta)):(i(),d("span",Fa," No Voucher Selected "))]))],2),e("div",{class:r(["px-4 py-2","flex","items-center","justify-between","hover:bg-[#E3F3E6]",{"opacity-50":t(B).isGuest}])},[e("div",Na,[x(t(Fe)),e("div",null,[Va,e("div",La,[t(B).isGuest?(i(),d("span",Ba," Accessible for registered users only ")):(i(),d("span",{key:1,class:r([M.value?"text-primary":"text-[#000000] opacity-50"])}," -"+_(t(F)("",parseInt(Z.value))),3))])])]),t(B).isGuest?I("",!0):(i(),d("div",Ga,[e("label",Ua,[V.value=="3"?re((i(),d("input",{key:0,type:"checkbox","onUpdate:modelValue":s[2]||(s[2]=$=>M.value=$),class:"sr-only peer",checked:"",disabled:t(B).isGuest||!M.value&&t(o).vouchers&&b()===0||Z.value===0},null,8,ja)),[[Xe,M.value]]):re((i(),d("input",{key:1,type:"checkbox","onUpdate:modelValue":s[3]||(s[3]=$=>M.value=$),class:"sr-only peer",checked:"",disabled:t(B).isGuest||!M.value&&t(o).vouchers&&t(v)===0||Z.value===0},null,8,Ha)),[[Xe,M.value]]),Za])]))],2),e("div",qa,[e("div",Ja,[x(t(Ht),{size:"24"}),e("div",null,[Wa,t(o).addOns.find($=>$.selected)?(i(),d("div",{key:0,class:r(["font-medium","text-12-16","","text-primary","flex","gap-[10.27px]"])},[Ka,e("div",za,[e("p",Ya,_(t(G)),1)])],2)):(i(),d("div",{key:1,class:r(["font-medium","text-12-16","","text-primary","cursor-pointer"]),onClick:s[4]||(s[4]=$=>be("hotel-addons"))}," Select Add-ons "))])]),t(o).addOns.find($=>$.selected)?I("",!0):(i(),d("div",Qa," No Add Ons "))]),e("div",Xa,[e("div",el,[x(t(Pt)),e("div",null,[tl,e("div",{class:r(["font-medium","text-12-16","","text-primary","cursor-pointer"]),onClick:s[5]||(s[5]=$=>(be("payment-option"),_t()))},[t(o).paymentMethod.hotel?(i(),d("span",ol," Select Payment Method ")):(i(),d("span",sl,"Update card details"))])])]),t(o).paymentMethod.hotel?(i(),d("div",al," Pay at Hotel ")):t(o).paymentMethod.cardDetails?(i(),d("div",ll,[e("img",{class:"w-6 h-6",src:((C=t(o).paymentMethod.cardDetails)==null?void 0:C.brand)==="amex"?t(Se)("americanexpress"):t(Se)((X=t(o).paymentMethod.cardDetails)==null?void 0:X.brand)},null,8,nl),e("span",null,_((ie=t(o).paymentMethod.cardDetails)==null?void 0:ie.last4),1)])):(i(),d("div",il,"None selected"))]),e("div",{class:r(["px-4 py-2","flex","items-start","justify-between","hover:bg-[#E3F3E6]"]),onClick:s[6]||(s[6]=$=>te.value=!0)},[e("div",dl,[e("div",null,[rl,e("div",cl,_(t(F)(E.fetchedDetails.currency,V.value=="3"?b():t(v),2)),1)]),e("div",ul,[ml,e("div",vl,[e("div",null,_(t(F)(E.fetchedDetails.currency,((de=t(w))==null?void 0:de.total_payable)??0,2)),1)])]),!t(o).paymentMethod.hotel&&t(A)===1?(i(),d("div",_l,[pl,e("div",hl,[e("div",null,_(t(F)(E.fetchedDetails.currency,(V.value=="3"?b():t(v))-((ve=t(w))==null?void 0:ve.total_payable),2)),1)])])):I("",!0),!t(o).paymentMethod.hotel&&t(A)===2?(i(),d("div",fl,[gl,e("div",yl,[e("div",null,_(t(F)(E.fetchedDetails.currency,parseFloat(t(w).total_payable-(V.value=="3"?b():t(v))),2)),1)])])):I("",!0),xl]),e("div",{class:r(["xs:hidden",["flex","gap-[10px]","items-start"]])},[e("div",null,[bl,wl,!t(o).paymentMethod.hotel&&t(A)===1?(i(),d("div",kl," Remaining Balance ")):I("",!0),!t(o).paymentMethod.hotel&&t(A)===2?(i(),d("div",Rl," Refundable ")):I("",!0),$l])]),e("div",Cl,[e("div",Ml,_(t(F)(E.fetchedDetails.currency,V.value=="3"?b():t(v),2)),1),e("div",Sl,[e("div",null,_(t(F)(E.fetchedDetails.currency,((pe=t(w))==null?void 0:pe.total_payable)??0,2)),1)]),!t(o).paymentMethod.hotel&&t(A)===1?(i(),d("div",Dl,[e("div",null,_(t(F)(E.fetchedDetails.currency,(V.value=="3"?b():t(v))-((Ie=t(w))==null?void 0:Ie.total_payable),2)),1)])):I("",!0),!t(o).paymentMethod.hotel&&t(A)===2?(i(),d("div",Al,[e("div",null,_(t(F)(E.fetchedDetails.currency,parseFloat(t(w).total_payable-(V.value=="3"?b():t(v))),2)),1)])):I("",!0)])]),e("button",{id:"confirm-submit-btn",type:"button",class:r(["btn","mt-2 mx-[18px]","btn-primary","py-[14px]","rounded-lg","text-sm","leading-[17px]","font-medium flex items-center justify-center","mb-5",{loading:N.value},{"btn-primary-disable":N.value||t(o).selectedRoom.isConfirmBtnDisabled}]),onClick:s[7]||(s[7]=$=>xe()),disabled:N.value||t(o).selectedRoom.isConfirmBtnDisabled},Il,10,Ol),x(Tt,{_mod_type:V.value,show:te.value,propertyDetail:t(O),fetchedDetails:E.fetchedDetails,computedRoomTotal:V.value=="3"?f():t(h),computedAddonTotal:t(c),computedVoucherTotal:V.value=="3"?parseFloat(we.value):t(u),computedPointsRedeemedTotal:g.value,computedTaxes:V.value=="3"?he():t(n),totalAmount:V.value=="3"?b():t(v),"onUpdate:show":s[8]||(s[8]=$=>te.value=$)},null,8,["_mod_type","show","propertyDetail","fetchedDetails","computedRoomTotal","computedAddonTotal","computedVoucherTotal","computedPointsRedeemedTotal","computedTaxes","totalAmount"]),x(t(Me),{show:ue.value,"onUpdate:show":s[11]||(s[11]=$=>ue.value=$),containerClass:"w-[300px] h-auto"},{default:Ae(()=>[e("div",Pl,[x(t(De))]),e("div",Tl,[Fl,Nl,Vl,e("div",Ll,[x(t(Te)),Bl]),e("div",Gl,[x(t(Fe)),Ul]),e("div",jl,[e("button",{type:"button",class:"py-[14px] btn-primary",onClick:s[9]||(s[9]=$=>l.$router.push({name:"BaseRoute::login"}))}," Login/Sign Up "),e("button",{type:"button",class:"py-[14px] mt-2 btn-primary-outline",onClick:s[10]||(s[10]=$=>{ue.value=!1,t(p).setScroll(1300)})}," Continue as Guest ")])])]),_:1},8,["show"]),x(Zt,{show:oe.value,"onUpdate:show":s[12]||(s[12]=$=>oe.value=$),"onUpdate:code":s[13]||(s[13]=$=>{oe.value=!1,t(o).paymentMethod.cardDetails.cvv=$,ge()})},null,8,["show"]),x(io,{show:le.value,"onUpdate:show":s[14]||(s[14]=$=>le.value=$),onProceed:s[15]||(s[15]=$=>{le.value=!1,rt()})},null,8,["show"]),x(qt,{totalAmount:V.value=="3"?b():t(v),totalAmountRaw:V.value=="3"?S():t(k),currency:E.fetchedDetails.currency},null,8,["totalAmount","totalAmountRaw","currency"]),x(t(Me),{show:ae.value,"onUpdate:show":s[17]||(s[17]=$=>ae.value=!1),containerClass:"w-[300px] h-auto"},{default:Ae(()=>[e("div",Hl,[e("div",Zl,[x(t(De))]),e("div",ql,_(H.value),1),e("div",Jl,[e("button",{type:"button",class:"py-[14px] btn-primary",onClick:s[16]||(s[16]=$=>dt())}," My Bookings ")])])]),_:1},8,["show"])])}}};const Ue=E=>(Dt("data-v-b3b940a7"),E=E(),At(),E),Kl={class:r(["mt-4","flex","gap-28","lg:flex-col md:mt-2 md:gap-8"])},zl={class:r(["flex-1","lg:w-full"])},Yl={class:r(["flex-1","bg-white"])},Ql={class:"flex justify-center"},Xl={class:"text-14-20"},en=Ue(()=>e("div",{class:"font-bold mt-5 text-center"}," Are you sure you want to leave? ",-1)),tn=Ue(()=>e("div",{class:"mt-5 text-center"}," It looks like you're in the middle of updating your booking and haven't save it. ",-1)),on=Ue(()=>e("div",{class:"mt-5 text-center"},"Save before you go!",-1)),sn={class:"mt-5 flex flex-col"},an={__name:"index",setup(E){const L=Ve(),ee=Le(),a=Ne(),B=St();lt();const W=K(()=>{var h;return(h=B.params)==null?void 0:h.confirmationNo}),p=y([{active:!1,label:"View Booking",to:"/booking/view/"},{active:!0,label:"",to:""}]),o=y(),te=y(!1),oe=K(()=>o.value.property_id),se=async()=>{try{const h=await zt(oe.value);let{ancillaries:f}=h.data;const{ancillary:c}=o.value;await M(f,c),o.value={...o.value,...h.data}}catch{}},ae=async()=>{try{const h=await Yt({confirmation_no:W.value});await ne(h.data[0])}catch{}},z=async(h,f,c)=>{let u=localStorage.getItem("_CURRENTVOUCHER_FROM_VIEW")?JSON.parse(localStorage.getItem("_CURRENTVOUCHER_FROM_VIEW")):null;if(u){if(!h.length)return"N/A";let g=0,k=0,S=0,D=h[0].multiplier;return h.forEach(v=>{v.discount_rate?g+=parseFloat(v.discount_rate):g+=parseFloat(u&&u.mod_type==3?v.base_rate:v.rate),D<v.multiplier&&(D=v.multiplier),k+=parseFloat(u.mod_type&&u.mod_type==3?v.base_rate:v.rate),S+=v.points}),f===1?F(c,Math.round(g)):f===2?F(c,Math.round(k)):f===3?F("",Math.round(S)):D}else{if(!h.length)return"N/A";let g=0,k=0,S=0,D=h[0].multiplier;return h.forEach(v=>{v.discount_rate?g+=parseFloat(v.discount_rate):g+=parseFloat(v.rate),parseFloat(D)<parseFloat(v.multiplier)&&(D=v.multiplier),k+=parseFloat(v.rate),S+=v.points}),f===1?F(c,Math.round(g)):f===2?F(c,Math.round(k)):f===3?F("",Math.round(S)):parseFloat(D)}},ne=async h=>{const{property_id:f,property_name:c,check_out:u,check_in:g,number_of_rooms:k,points_earned:S,rates:D,room_id:v,rate_id:b,rate_max_stay:A,rate_min_stay:w,invoice:Z,note:U,guests:n}=h;a.guestDetails=n,await Promise.all([H(c,f,g,u,k,D),le(Z,h),N(S,D,v,b,A,w,Z,U,h)])},H=(h,f,c,u,g,k)=>{a.booking.area=h,a.booking.propertyId=f,a.booking.startDate=c,a.booking.endDate=u,a.booking.roomCount=g,a.booking.stay=k==null?void 0:k.length,a.booking.bookDate=[c,u]},le=(h,f)=>{const{tax_fixed_title:c,tax_percent_title:u,service_charge_title:g,currency:k}=h;let S=[];u&&S.push(u),c&&S.push(c),g&&S.push(g),o.value={...f,currency:k,taxTitle:S}},N=async(h,f,c,u,g,k,S,D,v)=>{localStorage.removeItem("_ROOMRATES"),localStorage.removeItem("_ORIGINAL_ROOMRATES"),localStorage.setItem("_ROOMRATES",JSON.stringify(f)),localStorage.setItem("_ORIGINAL_ROOMRATES",JSON.stringify(f));let b=localStorage.getItem("_ROOMRATES")?JSON.parse(localStorage.getItem("_ROOMRATES")):[];const{currency:A}=S;a.setSelectedRoom({...v,currency:A,selected_number_of_rooms:v.number_of_rooms,plan:{rates:f},points:F("",h),multiplier:await z(b,4),stay:f==null?void 0:f.length,room:c,rate:u,discountedRate:null,rate:null,guestDetailsOld:JSON.stringify(v.guests),noteOld:D}),a.selectedRoom.discountedRate=await z(b,1,A),a.selectedRoom.rate=await z(b,2,A),a.selectedRoom,a.selectedRoom.maxStay=g,a.selectedRoom.minStay=k,a.additionalNotes=D;const Z=f.map(U=>U.available_room).reduce((U,n)=>(U=U>n?n:U,U));a.selectedRoom.available_room=Z},M=async(h,f)=>{const c=f.map(u=>({ancillary_id:u.ancillary_id,qty:u.quantity}));await h.forEach((u,g)=>{const k=c.find(S=>S.ancillary_id===u.id);k&&(h[g].count=k.qty,h[g].tempCount=k.qty,h[g].selected=!0)}),o.value={...o.value,ancillaries:h}},O=y(!1);J(()=>ee.isGuest,h=>{O.value=!0}),Be(async()=>{te.value=!0,L.alertModal.state=!1,a.voucherState=!1,a.selectedRoom.selected_number_of_rooms=1,await ae(),await se(),p.value[0].to+=W.value,p.value[1].label=a.booking.area,te.value=!1});const ue=it(),me=y(),G=y(!1);return Mt((h,f,c)=>{if(["BaseRoute::success","BaseRoute::login"].includes(h.name)){c();return}if(O.value){c();return}me.value=c,G.value=!0}),(h,f)=>(i(),d("div",{class:r(["bg-white px-36 pt-4 pb-16 md:px-4 md:bg-[#F6F6F6]",{"pointer-events-none":te.value}])},[te.value?(i(),Ge(t(Ot),{key:0})):I("",!0),x(t(gt),{class:"",items:p.value},null,8,["items"]),e("div",Kl,[e("div",zl,[x(na,{fetchedDetails:o.value},null,8,["fetchedDetails"])]),e("div",Yl,[x(Wl,{class:r(["w-full","lg:w-auto"]),fetchedDetails:o.value},null,8,["fetchedDetails"])])]),x(t(Me),{show:G.value,"onUpdate:show":f[2]||(f[2]=c=>G.value=c),containerClass:"w-[300px] h-auto"},{default:Ae(()=>[e("div",Ql,[x(t(De))]),e("div",Xl,[en,tn,on,e("div",sn,[e("button",{type:"button",class:"btn btn-primary font-normal",onClick:f[0]||(f[0]=c=>G.value=!1)}," Stay "),e("button",{type:"button",class:"mt-2 btn btn-primary-outline font-normal",onClick:f[1]||(f[1]=c=>{G.value=!1,me.value(),t(ue).bookingTransactionID=""})}," Leave ")])])]),_:1},8,["show"])],2))}},On=wt(an,[["__scopeId","data-v-b3b940a7"]]);export{On as default};
