import{e as I,s as V,E as C,B as A,r as l,l as j,c as n,a as o,i as q,u as k,C as r,t as g,q as R,F,k as z,p as H,H as L,n as M,d as U,z as J,o as a}from"./index-0d29c91c.js";import{u as K}from"./testData-146d1d9c.js";import{i as Q}from"./booking-84804f94.js";import{a as W}from"./manageBooking-5b991d8c.js";import{g as X}from"./manageBookingGuest-a3976bc7.js";import{e as O}from"./dateHelper-f75861f0.js";import"./AppLoader.vue_vue_type_style_index_0_lang-2e650906.js";/* empty css                                                               */import{_ as Y}from"./AppLoader-c0c74b58.js";import"./axiosConfig-15342d77.js";const Z={class:"flex justify-center pb-16 md:bg-[#F6F6F6]"},ee={class:"w-1/3 mt-7 md:w-full md:px-4"},te={class:"bg-[#FFF1F1] border border-[#DB1126] rounded-md py-5 px-6 text-sm"},oe=o("div",{class:"leading-6 font-bold mb-1"},"Cancel Booking",-1),se={key:0},ae={key:1},ne={key:2},le={class:"text-base mt-9"},ie=o("div",{class:"leading-6 font-bold"}," Tell us your reason for cancelling ",-1),re=["onSubmit"],ce=["onClick"],ue=["name","checked"],de={key:0,class:"border-t-[1px] border-[#B8B8B8] my-5"},me={key:0,class:"mt-5 flex flex-col gap-5"},fe=o("div",{class:"text-base"},"Please enter your reason",-1),pe={key:0,class:"text-sm text-red-600"},ve=o("div",{class:"border-t-[1px] border-[#D3D3D3]"},null,-1),_e={class:"flex justify-between mt-5 font-medium"},he=["disabled"],Me={__name:"index",setup(be){const B=I(),S=V(),N=U(),p=J(),d=C(()=>{var t;return(t=N.params)==null?void 0:t.confirmationNo}),v=A(),P=K(),c=l([{isSelected:!0,content:"I found an alternative accommodation option."},{isSelected:!1,content:"Personal reason/trip was called off."},{isSelected:!1,content:"Made booking for the same dates."},{isSelected:!1,content:"Change the destination."},{isSelected:!1,content:"Change in the number or need of travellers."},{isSelected:!1,content:"Others"}]),y=["Please select a cancellation reason. Note if you cancel, this booking is non-refundable.","Please select a cancellation reason. Please take note that this will cancel the entire booking and the action cannot be undone.","Please select a cancellation reason. Note if you cancel, this booking is non-refundable since it's already beyond the allowed period."],u=l(""),x=l(),m=l(!1),_=l(!1),f=l(!1),h=l(!1),E=t=>{c.value.forEach(e=>{e.isSelected=!1}),c.value[t].isSelected=!0,x.value=t},w=l(!1),D=C(()=>c.value.find(e=>e.isSelected).content!=="Others"?!1:w.value&&!u.value),T=async()=>{w.value=!0;const t=c.value.find(s=>s.isSelected);if(!t)return;let e={confirmation_no:d.value};if(t.content!=="Others")e.reason=t.content;else{if(u.value===""){console.log(u.value);return}e.reason=u.value}_.value=!0;try{const i=(await Q(e)).data.success;if(i!=="Booking cancelled.")B.alertModal={state:!0,content:i};else{if(S.isGuest||!v.isFromMyBookings){p.push({name:"BaseRoute::ViewBooking",params:{confirmationNo:d.value}});return}P.isCanceled=!0,p.push({name:"BaseRoute::ManageBooking"})}}catch(s){B.alertModal={state:!0,content:s.response.data.errors}}_.value=!1},b=()=>{p.push({name:"BaseRoute::home"})},$=async()=>{v.guestEmail||b(),m.value=!0;try{const e=(await X({email:v.guestEmail,confirmation_no:d.value})).data[0];e.status!==4&&b(),f.value=e.refund_policy===1,h.value=O(e==null?void 0:e.cancellation_days,e==null?void 0:e.check_in)}catch{b()}m.value=!1},G=async()=>{v.bookingNo=d.value,m.value=!0;try{const e=(await W({confirmation_no:d.value})).data[0];e.status!==4&&b(),f.value=e.refund_policy===1,h.value=O(e==null?void 0:e.cancellation_days,e==null?void 0:e.check_in)}catch{p.push({name:"BaseRoute::ManageBooking"})}m.value=!1};return j(async()=>{S.isGuest?await $():await G()}),(t,e)=>(a(),n("div",Z,[o("div",ee,[m.value?(a(),q(k(Y),{key:0})):r("",!0),o("div",te,[oe,f.value?r("",!0):(a(),n("div",se,g(y[0]),1)),f.value&&h.value?(a(),n("div",ae,g(y[1]),1)):r("",!0),f.value&&!h.value?(a(),n("div",ne,g(y[2]),1)):r("",!0)]),o("div",le,[ie,o("form",{onSubmit:R(T,["prevent"])},[(a(!0),n(F,null,z(c.value,(s,i)=>(a(),n(F,{key:s.content},[o("div",{class:"flex gap-5 mt-5 cursor-pointer",onClick:ge=>E(i)},[o("input",{type:"radio",name:`radio-${i}`,class:"radio-cancel accent-primary checked:bg-primary text-primary",checked:c.value[i].isSelected},null,8,ue),o("div",null,g(s.content),1)],8,ce),i!==5?(a(),n("div",de)):r("",!0)],64))),128)),x.value===5?(a(),n("div",me,[fe,o("div",null,[H(o("textarea",{"onUpdate:modelValue":e[0]||(e[0]=s=>u.value=s),class:M(["w-full h-[108px]","border border-[#D2D2D2]","focus-visible:outline-[#046A38]","px-2","py-[10px]","rounded-md",{"border-red-500 focus-visible:outline-red-500":k(D)}])},null,2),[[L,u.value,void 0,{trim:!0}]]),k(D)?(a(),n("p",pe," This field is required. ")):r("",!0)]),ve])):r("",!0),o("div",_e,[o("button",{type:"button",class:"py-4 px-10 btn btn-primary-outline",onClick:e[1]||(e[1]=R(s=>t.$router.go(-1),["prevent"]))}," Back "),o("button",{class:M(["py-4 px-10 btn btn-primary rounded-lg",{"btn-primary-disable loading":_.value}]),disabled:_.value,type:"submit"}," Submit ",10,he)])],40,re)])])]))}};export{Me as default};
